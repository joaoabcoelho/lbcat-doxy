\hypertarget{classICECALv3}{}\section{I\+C\+E\+C\+A\+Lv3 Class Reference}
\label{classICECALv3}\index{I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}}


{\ttfamily \#include $<$I\+C\+E\+C\+A\+Lv3.\+h$>$}

Inheritance diagram for I\+C\+E\+C\+A\+Lv3\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=5.000000cm]{classICECALv3}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classICECALv3_a0a8b12d2b6bafca9cd820301fc93dff8}{I\+C\+E\+C\+A\+Lv3} ()
\item 
void \hyperlink{classICECALv3_aaf38119f47401a85022ae1b0d05675bd}{set\+Address} (\hyperlink{ICECALv3_8h_a3cb25ca6f51f003950f9625ff05536fc}{U8} address)
\item 
void \hyperlink{classICECALv3_aae0b7539c0bba5311aab99e000d1be6d}{set\+N\+Retries} (int n\+Ret)
\item 
void \hyperlink{classICECALv3_a1b9ca0e09d45634a70da6f19a7257314}{reset\+Pumps} ()
\item 
void \hyperlink{classICECALv3_a5ce36881aa89fedf7c37e03620acca6e}{bypass\+Miso\+Mosi} (\hyperlink{ICECALv3_8h_adf928e51a60dba0df29d615401cc55a8}{U16} write\+Data)
\item 
Py\+Object $\ast$ \hyperlink{classICECALv3_a7a1c1706a455903f42bb9a5257d94a78}{get\+Delay\+Line\+Ch} (int ch)
\item 
\hyperlink{classStatusCode}{Status\+Code} \hyperlink{classICECALv3_a14a7a29c9a3412c062f053cc616b860a}{set\+Delay\+Line\+Ch} (int ch, Py\+Object $\ast$)
\item 
Py\+Object $\ast$ \hyperlink{classICECALv3_a5f1414e6049a82eafdd505a88d7d0c91}{get\+Analog\+Ch} (int ch)
\item 
\hyperlink{classStatusCode}{Status\+Code} \hyperlink{classICECALv3_a9578e4d13c250d8bc417f68c79d6a21d}{set\+Analog\+Ch} (int ch, Py\+Object $\ast$)
\item 
Py\+Object $\ast$ \hyperlink{classICECALv3_a4a414d23c1e199b446dc876161338148}{get\+Main\+Reg} ()
\item 
\hyperlink{classStatusCode}{Status\+Code} \hyperlink{classICECALv3_a479f7e17669da4b785af840049d39cb4}{set\+Main\+Reg} (Py\+Object $\ast$)
\item 
Py\+Object $\ast$ \hyperlink{classICECALv3_a8639cf6a44cba85b53128b5e1dc21e15}{spi\+F\+E\+R\+Test} (long n\+Test)
\item 
\hyperlink{classStatusCode}{Status\+Code} \hyperlink{classICECALv3_ac26be912fb72e615106fceb4626aa548}{dump\+Config} (string config\+File, Py\+Object $\ast$chip\+Id)
\item 
Py\+Object $\ast$ \hyperlink{classICECALv3_a514456dd303e897aa1b55dccf3fa66d0}{load\+Config} (string config\+File)
\item 
double \hyperlink{classICECALv3_a7f3f8012d2e5c45f8e43819befa3f915}{version} ()
\item 
bool \hyperlink{classICECALv3_a545f51b915a6de5c5f450622d0651a85}{bxid\+Resynch\+Status} ()
\item 
void \hyperlink{classICECALv3_acbf1a7a8510d7e02280bacc58badf4f4}{spi\+Address\+Scan} ()
\item 
\hyperlink{classICECALv3_acdadf9483fc38a615192de41548024a1}{$\sim$\+I\+C\+E\+C\+A\+Lv3} ()
\item 
void \hyperlink{classICECALv3_a00e572849b4952e7cf04a39f992df037}{help} ()
\item 
\hyperlink{classStatusCode}{Status\+Code} \hyperlink{classICECALv3_abf7281fad80b80b70c5b13ce66ba3451}{init} ()
\item 
void \hyperlink{classICECALv3_a33afc7c8e0f399336152abd03cbe8d1b}{reset} ()
\item 
void \hyperlink{classICECALv3_ab2a00809e9a4f2ab83ef041a886ca637}{update} ()
\end{DoxyCompactItemize}
\subsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{ICECALv3_8h_adf928e51a60dba0df29d615401cc55a8}{U16} \hyperlink{classICECALv3_aced41ce20a0853d6248b8df88412e57a}{spi\+Read} (\hyperlink{ICECALv3_8h_a3cb25ca6f51f003950f9625ff05536fc}{U8} conf\+Reg\+Addr, \hyperlink{ICECALv3_8h_a3cb25ca6f51f003950f9625ff05536fc}{U8} offset\+Addr=128)
\item 
void \hyperlink{classICECALv3_aef00f02801dea4bda2093c930501dcdd}{spi\+Write} (\hyperlink{ICECALv3_8h_a3cb25ca6f51f003950f9625ff05536fc}{U8} conf\+Reg\+Addr, \hyperlink{ICECALv3_8h_adf928e51a60dba0df29d615401cc55a8}{U16} \hyperlink{structconfRegData}{conf\+Reg\+Data})
\item 
bool \hyperlink{classICECALv3_aa0b8358ea0be8e47a8aded5e1551787f}{spi\+Write\+Safe} (\hyperlink{ICECALv3_8h_a3cb25ca6f51f003950f9625ff05536fc}{U8} conf\+Reg\+Addr, \hyperlink{ICECALv3_8h_adf928e51a60dba0df29d615401cc55a8}{U16} \hyperlink{structconfRegData}{conf\+Reg\+Data})
\item 
bool \hyperlink{classICECALv3_a9d7c33e6d113e7f721dc848d28ab44d8}{write\+Asic\+Params} (string file\+Name, Py\+Object $\ast$params)
\item 
int \hyperlink{classICECALv3_a313e8166af1ce26b4026f883ad900fb9}{parse\+Parameter\+List} (string config\+File, string param\+Name\mbox{[}64\mbox{]}, int param\+Value\mbox{[}64\mbox{]})
\item 
Py\+Object $\ast$ \hyperlink{classICECALv3_ac006abc42a048308427f6801d783a407}{fill\+Params} (string param\+List\+Ret\mbox{[}$\,$\mbox{]}, int param\+List\+Len, string param\+Name\mbox{[}64\mbox{]}, int param\+Value\mbox{[}64\mbox{]}, int file\+Param\+Len)
\item 
bool \hyperlink{classICECALv3_a8753a74558f988b346a3fe350c5bbad4}{check\+Ch\+Number} (int ch)
\item 
std\+::string \hyperlink{classICECALv3_a04b02e583f191bfce34d05132cd23834}{itohs} (int value)
\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classRegister}{Register} $\ast$ \hyperlink{classICECALv3_a6e8b6c03f5b0f1d8281bf8a0fa46064f}{conf\+Reg}
\item 
int \hyperlink{classICECALv3_ae877ce34b3a4d6c368cc6409ac9614fa}{n\+Retries}
\item 
bool \hyperlink{classICECALv3_ad8989925ee5b3ff322d863ce6aaff0bd}{err}
\end{DoxyCompactItemize}
\subsection*{Additional Inherited Members}


\subsection{Detailed Description}


Definition at line 58 of file I\+C\+E\+C\+A\+Lv3.\+h.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classICECALv3_a0a8b12d2b6bafca9cd820301fc93dff8}\label{classICECALv3_a0a8b12d2b6bafca9cd820301fc93dff8}} 
\index{I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}!I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}}
\index{I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}!I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}}
\subsubsection{\texorpdfstring{I\+C\+E\+C\+A\+Lv3()}{ICECALv3()}}
{\footnotesize\ttfamily I\+C\+E\+C\+A\+Lv3\+::\+I\+C\+E\+C\+A\+Lv3 (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 16 of file I\+C\+E\+C\+A\+Lv3.\+cpp.



References Attrib\+::add(), Hierarchy\+::add\+Child(), I\+Odata\+::\+Byte, conf\+Reg, Object\+::debug(), I\+Odata\+::def\+Data\+U8(), Attrib\+::\+E\+L\+E\+M\+E\+NT, Attrib\+::\+H\+A\+R\+D\+W\+A\+RE, I\+Oobject\+::io(), Object\+::set\+Id(), Object\+::set\+Name(), I\+Odata\+::set\+Sub\+Address(), Object\+::set\+Type(), and I\+Odata\+::set\+Word\+Size().


\begin{DoxyCode}
16                   \{
17     \hyperlink{classObject_aae534cc9d982bcb9b99fd505f2e103a5}{setType}(\textcolor{stringliteral}{"ICECALv3"});
18     \hyperlink{classObject_a398fe08cba594a0ce6891d59fe4f159f}{setId}(0);
19 
20     \hyperlink{classAttrib_a235f773af19c900264a190b00a3b4ad7}{add}(\hyperlink{classAttrib_a69e171d7cc6417835a5a306d3c764235a7788bc5dd333fd8ce18562b269c9dab1}{Attrib::ELEMENT}); \hyperlink{classAttrib_a235f773af19c900264a190b00a3b4ad7}{add} (\hyperlink{classAttrib_a69e171d7cc6417835a5a306d3c764235a61ceb22149f365f1780d18f9d1459423}{Attrib::HARDWARE});
21     \hyperlink{classObject_aac010553f022165573714b7014a15f0d}{debug}(\textcolor{stringliteral}{"ICECALv3 built."},\textcolor{stringliteral}{"ICECALv3::ICECALv3"});
22 
23     \textcolor{comment}{//Configuration register initilization:}
24     \textcolor{comment}{//Sub-address = 9.}
25     \textcolor{comment}{//#bytes = 3 (address + data<1> + data<0>).}
26     \hyperlink{classICECALv3_a6e8b6c03f5b0f1d8281bf8a0fa46064f}{confReg}=\textcolor{keyword}{new} \hyperlink{classRegister}{Register}();
27     \hyperlink{classICECALv3_a6e8b6c03f5b0f1d8281bf8a0fa46064f}{confReg}->\hyperlink{classObject_ae30fea75683c2d149b6b6d17c09ecd0c}{setName}(\textcolor{stringliteral}{"ConfigRegister"});
28     \hyperlink{classICECALv3_a6e8b6c03f5b0f1d8281bf8a0fa46064f}{confReg}->\hyperlink{classIOobject_af04fb94137c3d86849f478ac5afab5d1}{io}()->\hyperlink{classIOdata_aeca09aa9a8c2ccc4c3a728b2ddcf4b2a}{setSubAddress}(9);    
29     \hyperlink{classICECALv3_a6e8b6c03f5b0f1d8281bf8a0fa46064f}{confReg}->\hyperlink{classIOobject_af04fb94137c3d86849f478ac5afab5d1}{io}()->\hyperlink{classIOdata_a80bb230b61062b447db5832e43bf7b44}{defDataU8}(3);    
30     \hyperlink{classICECALv3_a6e8b6c03f5b0f1d8281bf8a0fa46064f}{confReg}->\hyperlink{classIOobject_af04fb94137c3d86849f478ac5afab5d1}{io}()->\hyperlink{classIOdata_a20f30a9f4673713616447b1b5e9817d5}{setWordSize}(\hyperlink{classIOdata_a37c53ebf4bf8d866aac8af572962a84ca00156611f08eeb1b5d361de809dafb8e}{IOdata::Byte});
31 
32     \hyperlink{classHierarchy_ad677774ff38fcb257c04a3a10d471fac}{addChild}(\hyperlink{classICECALv3_a6e8b6c03f5b0f1d8281bf8a0fa46064f}{confReg});   
33 \}
\end{DoxyCode}
\mbox{\Hypertarget{classICECALv3_acdadf9483fc38a615192de41548024a1}\label{classICECALv3_acdadf9483fc38a615192de41548024a1}} 
\index{I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}!````~I\+C\+E\+C\+A\+Lv3@{$\sim$\+I\+C\+E\+C\+A\+Lv3}}
\index{````~I\+C\+E\+C\+A\+Lv3@{$\sim$\+I\+C\+E\+C\+A\+Lv3}!I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}}
\subsubsection{\texorpdfstring{$\sim$\+I\+C\+E\+C\+A\+Lv3()}{~ICECALv3()}}
{\footnotesize\ttfamily I\+C\+E\+C\+A\+Lv3\+::$\sim$\+I\+C\+E\+C\+A\+Lv3 (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line 98 of file I\+C\+E\+C\+A\+Lv3.\+h.


\begin{DoxyCode}
98              \{
99   \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classICECALv3_a545f51b915a6de5c5f450622d0651a85}\label{classICECALv3_a545f51b915a6de5c5f450622d0651a85}} 
\index{I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}!bxid\+Resynch\+Status@{bxid\+Resynch\+Status}}
\index{bxid\+Resynch\+Status@{bxid\+Resynch\+Status}!I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}}
\subsubsection{\texorpdfstring{bxid\+Resynch\+Status()}{bxidResynchStatus()}}
{\footnotesize\ttfamily bool I\+C\+E\+C\+A\+Lv3\+::bxid\+Resynch\+Status (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 677 of file I\+C\+E\+C\+A\+Lv3.\+cpp.



References B\+X\+I\+D\+\_\+\+R\+E\+S\+Y\+N\+C\+H\+\_\+\+A\+D\+DR, Object\+::info(), itohs(), and spi\+Read().



Referenced by B\+O\+O\+S\+T\+\_\+\+P\+Y\+T\+H\+O\+N\+\_\+\+M\+O\+D\+U\+L\+E().


\begin{DoxyCode}
678 \{
679     \hyperlink{ICECALv3_8h_adf928e51a60dba0df29d615401cc55a8}{U16} rxData;
680 
681     rxData = \hyperlink{classICECALv3_aced41ce20a0853d6248b8df88412e57a}{spiRead}(\hyperlink{ICECALv3_8h_a57a201af9e55ffd847b551bff2dc71ce}{BXID\_RESYNCH\_ADDR}, 0x00 );
682 
683     \hyperlink{classObject_a644fd329ea4cb85f54fa6846484b84a8}{info}(\textcolor{stringliteral}{"RX = "} + \hyperlink{classICECALv3_a04b02e583f191bfce34d05132cd23834}{itohs}(rxData),\textcolor{stringliteral}{""});
684     \textcolor{keywordflow}{return}(rxData > 127);
685 
686 \}
\end{DoxyCode}
\mbox{\Hypertarget{classICECALv3_a5ce36881aa89fedf7c37e03620acca6e}\label{classICECALv3_a5ce36881aa89fedf7c37e03620acca6e}} 
\index{I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}!bypass\+Miso\+Mosi@{bypass\+Miso\+Mosi}}
\index{bypass\+Miso\+Mosi@{bypass\+Miso\+Mosi}!I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}}
\subsubsection{\texorpdfstring{bypass\+Miso\+Mosi()}{bypassMisoMosi()}}
{\footnotesize\ttfamily void I\+C\+E\+C\+A\+Lv3\+::bypass\+Miso\+Mosi (\begin{DoxyParamCaption}\item[{\hyperlink{ICECALv3_8h_adf928e51a60dba0df29d615401cc55a8}{U16}}]{write\+Data }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line 70 of file I\+C\+E\+C\+A\+Lv3.\+h.



References S\+C\+\_\+\+M\+O\+S\+I\+\_\+\+M\+I\+S\+O\+\_\+\+B\+Y\+P\+A\+SS.


\begin{DoxyCode}
70 \{       \hyperlink{classICECALv3_aef00f02801dea4bda2093c930501dcdd}{spiWrite}(\hyperlink{ICECALv3_8h_a2870f5a3cad23b2b4e7f16faefe8ef2e}{SC\_MOSI\_MISO\_BYPASS},writeData); \};
\end{DoxyCode}
\mbox{\Hypertarget{classICECALv3_a8753a74558f988b346a3fe350c5bbad4}\label{classICECALv3_a8753a74558f988b346a3fe350c5bbad4}} 
\index{I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}!check\+Ch\+Number@{check\+Ch\+Number}}
\index{check\+Ch\+Number@{check\+Ch\+Number}!I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}}
\subsubsection{\texorpdfstring{check\+Ch\+Number()}{checkChNumber()}}
{\footnotesize\ttfamily bool I\+C\+E\+C\+A\+Lv3\+::check\+Ch\+Number (\begin{DoxyParamCaption}\item[{int}]{ch }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Definition at line 155 of file I\+C\+E\+C\+A\+Lv3.\+h.



References itos().


\begin{DoxyCode}
156     \{
157         \textcolor{keywordflow}{if}(ch < 0 || ch > 3) \{
158             \hyperlink{classObject_a204a95f57818c0f811933917a30eff45}{error}(\hyperlink{Tools_8h_af330027dbdafb9a30768b3613c553e60}{itos}(ch)+\textcolor{stringliteral}{" is not a valid ICECAL channel number. Valid numbers [0-3]."},\textcolor{stringliteral}{"
      ICECALv3::checkChNumber"});
159             \textcolor{keywordflow}{return} \textcolor{keyword}{false};
160         \}
161         \textcolor{keywordflow}{else} \textcolor{keywordflow}{return} \textcolor{keyword}{true};
162     \}
\end{DoxyCode}
\mbox{\Hypertarget{classICECALv3_ac26be912fb72e615106fceb4626aa548}\label{classICECALv3_ac26be912fb72e615106fceb4626aa548}} 
\index{I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}!dump\+Config@{dump\+Config}}
\index{dump\+Config@{dump\+Config}!I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}}
\subsubsection{\texorpdfstring{dump\+Config()}{dumpConfig()}}
{\footnotesize\ttfamily \hyperlink{classStatusCode}{Status\+Code} I\+C\+E\+C\+A\+Lv3\+::dump\+Config (\begin{DoxyParamCaption}\item[{string}]{config\+File,  }\item[{Py\+Object $\ast$}]{chip\+Id }\end{DoxyParamCaption})}



Definition at line 132 of file I\+C\+E\+C\+A\+Lv3.\+cpp.



References Status\+Code\+::\+F\+A\+I\+L\+U\+RE, get\+Analog\+Ch(), get\+Delay\+Line\+Ch(), get\+Main\+Reg(), Status\+Code\+::\+S\+U\+C\+C\+E\+SS, and write\+Asic\+Params().



Referenced by B\+O\+O\+S\+T\+\_\+\+P\+Y\+T\+H\+O\+N\+\_\+\+M\+O\+D\+U\+L\+E().


\begin{DoxyCode}
133 \{
134     PyObject* asicParams = PyList\_New(0);
135     \textcolor{keywordtype}{bool} ok;
136 
137     \textcolor{comment}{//The first list item is the Chip Identifier.}
138     PyList\_Append(asicParams, chipId);
139 
140     \textcolor{comment}{//Let's ask for the configuration to our chip.}
141     \textcolor{comment}{//Each function will return the corresponding parameter list}
142     \textcolor{comment}{//of that register.}
143     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<4;i++)
144     \{
145         PyList\_Append(asicParams, \hyperlink{classICECALv3_a7a1c1706a455903f42bb9a5257d94a78}{getDelayLineCh}(i) );
146         PyList\_Append(asicParams, \hyperlink{classICECALv3_a5f1414e6049a82eafdd505a88d7d0c91}{getAnalogCh}(i) );
147     \}
148     PyList\_Append(asicParams, \hyperlink{classICECALv3_a4a414d23c1e199b446dc876161338148}{getMainReg}() );
149 
150     ok = \hyperlink{classICECALv3_a9d7c33e6d113e7f721dc848d28ab44d8}{writeAsicParams}(configFile,asicParams);
151 
152     \textcolor{keywordflow}{if}(ok) \textcolor{keywordflow}{return} \hyperlink{classStatusCode_a6f565cbeadc76d14c72f047e5e85eb4badd0da38d3ba0d922efd1f4619bc37ad8}{StatusCode::SUCCESS};
153     \textcolor{keywordflow}{else}   \textcolor{keywordflow}{return} \hyperlink{classStatusCode_a6f565cbeadc76d14c72f047e5e85eb4ba3da73d4c469762eb9d3c960368252b26}{StatusCode::FAILURE};
154 \}
\end{DoxyCode}
\mbox{\Hypertarget{classICECALv3_ac006abc42a048308427f6801d783a407}\label{classICECALv3_ac006abc42a048308427f6801d783a407}} 
\index{I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}!fill\+Params@{fill\+Params}}
\index{fill\+Params@{fill\+Params}!I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}}
\subsubsection{\texorpdfstring{fill\+Params()}{fillParams()}}
{\footnotesize\ttfamily Py\+Object $\ast$ I\+C\+E\+C\+A\+Lv3\+::fill\+Params (\begin{DoxyParamCaption}\item[{string}]{param\+List\+Ret\mbox{[}$\,$\mbox{]},  }\item[{int}]{param\+List\+Len,  }\item[{string}]{param\+Name\mbox{[}64\mbox{]},  }\item[{int}]{param\+Value\mbox{[}64\mbox{]},  }\item[{int}]{file\+Param\+Len }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 106 of file I\+C\+E\+C\+A\+Lv3.\+cpp.



Referenced by load\+Config().


\begin{DoxyCode}
107 \{
108     \textcolor{keywordtype}{int} iParamFile;
109     \textcolor{keywordtype}{bool} found;
110     PyObject* asicParams = PyList\_New(0);
111 
112     \textcolor{comment}{//For each of the parameters of the list...}
113     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} iList=0 ; iList<paramListLen ; iList++)
114     \{
115         iParamFile=0;
116         found = \textcolor{keyword}{false};
117         \textcolor{comment}{//We look for the parameter name in the C++ dictionary.}
118         \textcolor{keywordflow}{while}(iParamFile < fileParamLen && !found)
119         \{
120             \textcolor{keywordflow}{if}(paramName[iParamFile].find(paramListRet[iList]) != string::npos)
121             \{
122                 PyList\_Append(asicParams, PyInt\_FromLong(paramValue[iParamFile]));
123                 found = \textcolor{keyword}{true};
124             \}
125             iParamFile++;
126         \}
127     \}
128     \textcolor{keywordflow}{return} asicParams;
129 \}
\end{DoxyCode}
\mbox{\Hypertarget{classICECALv3_a5f1414e6049a82eafdd505a88d7d0c91}\label{classICECALv3_a5f1414e6049a82eafdd505a88d7d0c91}} 
\index{I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}!get\+Analog\+Ch@{get\+Analog\+Ch}}
\index{get\+Analog\+Ch@{get\+Analog\+Ch}!I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}}
\subsubsection{\texorpdfstring{get\+Analog\+Ch()}{getAnalogCh()}}
{\footnotesize\ttfamily Py\+Object $\ast$ I\+C\+E\+C\+A\+Lv3\+::get\+Analog\+Ch (\begin{DoxyParamCaption}\item[{int}]{ch }\end{DoxyParamCaption})}



Definition at line 312 of file I\+C\+E\+C\+A\+Lv3.\+cpp.



References err, icecal\+L\+S\+B\+Addr\+Ch, icecal\+M\+S\+B\+Addr\+Ch, Object\+::info(), itohs(), itos(), and spi\+Read().



Referenced by B\+O\+O\+S\+T\+\_\+\+P\+Y\+T\+H\+O\+N\+\_\+\+M\+O\+D\+U\+L\+E(), and dump\+Config().


\begin{DoxyCode}
313 \{                            
314     \hyperlink{ICECALv3_8h_a3cb25ca6f51f003950f9625ff05536fc}{U8} spiLsbAddr = \hyperlink{ICECALv3_8h_abd124f50fa794b9b0aded801fabf5322}{icecalLSBAddrCh}[ch];           \textcolor{comment}{//The SPI address of the 16 LSBs.}
315     \hyperlink{ICECALv3_8h_a3cb25ca6f51f003950f9625ff05536fc}{U8} spiMsbAddr = \hyperlink{ICECALv3_8h_afba64a649cc9314882fd49b62b99d6e7}{icecalMSBAddrCh}[ch];           \textcolor{comment}{//The SPI address of the 16 MSBs.}
316 
317     \textcolor{keywordtype}{int} cIntMsb, cIntLsb0, cIntLsb1, iOffMsb, cIntSubCh0, cIntSubCh1, iOffLsb0, iOffLsb1, iOffSubCh0, 
      iOffSubCh1, zero, pole, zIn;
318     PyObject* icecalChParams = PyList\_New(0);
319 
320     \textcolor{comment}{//32 bit register from two SPI 16-bit registers.}
321     \hyperlink{ICECALv3_8h_a811024d35b9b8a41095b1f583b649e56}{U32} rxData = (\hyperlink{classICECALv3_aced41ce20a0853d6248b8df88412e57a}{spiRead}(spiMsbAddr) << 16) | \hyperlink{classICECALv3_aced41ce20a0853d6248b8df88412e57a}{spiRead}(spiLsbAddr);
322 
323     \textcolor{keywordflow}{if}(\hyperlink{classICECALv3_ad8989925ee5b3ff322d863ce6aaff0bd}{err}) PyList\_Append(icecalChParams, PyInt\_FromLong(-1));
324     \textcolor{keywordflow}{else}
325     \{
326         cIntMsb     = (rxData >> 30) & 0x03;        \textcolor{comment}{//2 bits.}
327         cIntLsb0    = (rxData >> 27) & 0x07;        \textcolor{comment}{//3 bits.}
328         cIntLsb1    = (rxData >> 24) & 0x07;        \textcolor{comment}{//3 bits.}
329         iOffMsb     = (rxData >> 20) & 0x0F;        \textcolor{comment}{//4 bits.}
330         iOffLsb0    = (rxData >> 18) & 0x03;        \textcolor{comment}{//2 bits.}
331         iOffLsb1    = (rxData >> 16) & 0x03;        \textcolor{comment}{//2 bits.}
332         zero            = (rxData >> 11) & 0x1F;        \textcolor{comment}{//5 bits.}
333         pole            = (rxData >> 5)  & 0x3F;        \textcolor{comment}{//6 bits.}
334         zIn             = (rxData)           & 0x1F;        \textcolor{comment}{//5 bits.}
335 
336         cIntSubCh0 = (cIntMsb << 3) | cIntLsb0;     \textcolor{comment}{//cInt: The 2 MSB are shared between subchannels.}
337         cIntSubCh1 = (cIntMsb << 3) | cIntLsb1;     \textcolor{comment}{//The 3 LSB may differ from subchannels.}
338         iOffSubCh0 = (iOffMsb << 2) | iOffLsb0;     \textcolor{comment}{//iOff: 4 common + 2 different.}
339         iOffSubCh1 = (iOffMsb << 2) | iOffLsb1;
340 
341         PyList\_Append(icecalChParams, PyInt\_FromLong(cIntSubCh0));
342         PyList\_Append(icecalChParams, PyInt\_FromLong(cIntSubCh1));
343         PyList\_Append(icecalChParams, PyInt\_FromLong(iOffSubCh0));
344         PyList\_Append(icecalChParams, PyInt\_FromLong(iOffSubCh1));
345         PyList\_Append(icecalChParams, PyInt\_FromLong(zero));
346         PyList\_Append(icecalChParams, PyInt\_FromLong(pole));
347         PyList\_Append(icecalChParams, PyInt\_FromLong(zIn));
348 
349         \hyperlink{classObject_a644fd329ea4cb85f54fa6846484b84a8}{info}(\textcolor{stringliteral}{"ICECAL Analog Channel <"}+\hyperlink{Tools_8h_af330027dbdafb9a30768b3613c553e60}{itos}(ch)+\textcolor{stringliteral}{"> (MSB @SPI = 0x"}+\hyperlink{classICECALv3_a04b02e583f191bfce34d05132cd23834}{itohs}(spiMsbAddr)+\textcolor{stringliteral}{". LSB
       @SPI = 0x"}+\hyperlink{classICECALv3_a04b02e583f191bfce34d05132cd23834}{itohs}(spiLsbAddr)+\textcolor{stringliteral}{"):"},\textcolor{stringliteral}{"ICECALv3::getIcecal"});
350         \hyperlink{classObject_a644fd329ea4cb85f54fa6846484b84a8}{info}(\textcolor{stringliteral}{"   ·Integrator capacitor SubCh<0> : "}+\hyperlink{Tools_8h_af330027dbdafb9a30768b3613c553e60}{itos}(cIntSubCh0)    ,\textcolor{stringliteral}{"ICECALv3::getAnalogCh"});
351         \hyperlink{classObject_a644fd329ea4cb85f54fa6846484b84a8}{info}(\textcolor{stringliteral}{"   ·Integrator capacitor SubCh<1> : "}+\hyperlink{Tools_8h_af330027dbdafb9a30768b3613c553e60}{itos}(cIntSubCh1)    ,\textcolor{stringliteral}{"ICECALv3::getAnalogCh"});
352         \hyperlink{classObject_a644fd329ea4cb85f54fa6846484b84a8}{info}(\textcolor{stringliteral}{"   ·Offset Current SubCh<0>       : "}+\hyperlink{Tools_8h_af330027dbdafb9a30768b3613c553e60}{itos}(iOffSubCh0)    ,\textcolor{stringliteral}{"ICECALv3::getAnalogCh"});
353         \hyperlink{classObject_a644fd329ea4cb85f54fa6846484b84a8}{info}(\textcolor{stringliteral}{"   ·Offset Current SubCh<1>       : "}+\hyperlink{Tools_8h_af330027dbdafb9a30768b3613c553e60}{itos}(iOffSubCh1)    ,\textcolor{stringliteral}{"ICECALv3::getAnalogCh"});
354         \hyperlink{classObject_a644fd329ea4cb85f54fa6846484b84a8}{info}(\textcolor{stringliteral}{"   ·PZ Zero capacitor             : "}+\hyperlink{Tools_8h_af330027dbdafb9a30768b3613c553e60}{itos}(zero)              ,\textcolor{stringliteral}{"ICECALv3::getAnalogCh
      "});
355         \hyperlink{classObject_a644fd329ea4cb85f54fa6846484b84a8}{info}(\textcolor{stringliteral}{"   ·PZ Pole capacitor             : "}+\hyperlink{Tools_8h_af330027dbdafb9a30768b3613c553e60}{itos}(pole)              ,\textcolor{stringliteral}{"ICECALv3::getAnalogCh
      "});
356         \hyperlink{classObject_a644fd329ea4cb85f54fa6846484b84a8}{info}(\textcolor{stringliteral}{"   ·Input impedance control       : "}+\hyperlink{Tools_8h_af330027dbdafb9a30768b3613c553e60}{itos}(zIn)                   ,\textcolor{stringliteral}{"
      ICECALv3::getAnalogCh"});
357     \}
358     \textcolor{keywordflow}{return} icecalChParams;
359 \}
\end{DoxyCode}
\mbox{\Hypertarget{classICECALv3_a7a1c1706a455903f42bb9a5257d94a78}\label{classICECALv3_a7a1c1706a455903f42bb9a5257d94a78}} 
\index{I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}!get\+Delay\+Line\+Ch@{get\+Delay\+Line\+Ch}}
\index{get\+Delay\+Line\+Ch@{get\+Delay\+Line\+Ch}!I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}}
\subsubsection{\texorpdfstring{get\+Delay\+Line\+Ch()}{getDelayLineCh()}}
{\footnotesize\ttfamily Py\+Object $\ast$ I\+C\+E\+C\+A\+Lv3\+::get\+Delay\+Line\+Ch (\begin{DoxyParamCaption}\item[{int}]{ch }\end{DoxyParamCaption})}



Definition at line 246 of file I\+C\+E\+C\+A\+Lv3.\+cpp.



References delay\+Line\+Addr\+Ch, err, Object\+::info(), itohs(), itos(), and spi\+Read().



Referenced by B\+O\+O\+S\+T\+\_\+\+P\+Y\+T\+H\+O\+N\+\_\+\+M\+O\+D\+U\+L\+E(), and dump\+Config().


\begin{DoxyCode}
247 \{                            
248     \hyperlink{ICECALv3_8h_a3cb25ca6f51f003950f9625ff05536fc}{U8} spiAddr = \hyperlink{ICECALv3_8h_a848408b773702d268053cb49d205e097}{delayLineAddrCh}[ch];          \textcolor{comment}{//The SPI address of this delay line
       channel.}
249     \hyperlink{ICECALv3_8h_adf928e51a60dba0df29d615401cc55a8}{U16} rxData = \hyperlink{classICECALv3_aced41ce20a0853d6248b8df88412e57a}{spiRead}(spiAddr);                \textcolor{comment}{//rxData contains the 16 bits corresponding to
       the delay line channel.}
250 
251     \textcolor{keywordtype}{int} phaseADC, phaseTH, phaseINT, locSel, lvdsOEn;
252     PyObject* dllParams = PyList\_New(0);
253 
254     \textcolor{keywordflow}{if}(\hyperlink{classICECALv3_ad8989925ee5b3ff322d863ce6aaff0bd}{err}) PyList\_Append(dllParams, PyInt\_FromLong(-1));
255     \textcolor{keywordflow}{else}
256     \{
257         phaseADC = (rxData >> 11) & 0x1F;       \textcolor{comment}{//5 bits.}
258         phaseTH  = (rxData >> 6 ) & 0x1F;       \textcolor{comment}{//5 bits.}
259         phaseINT = (rxData >> 3 ) & 0x07;       \textcolor{comment}{//3 bits.}
260         locSel   = (rxData >> 1 ) & 0x03;       \textcolor{comment}{//2 bits.}
261         lvdsOEn  = (rxData & 0x01);                 \textcolor{comment}{//1 bit.}
262 
263         \textcolor{comment}{//Converts integers to PyInt objects and then appends them to the PyList}
264         PyList\_Append(dllParams, PyInt\_FromLong(phaseADC));
265         PyList\_Append(dllParams, PyInt\_FromLong(phaseTH));
266         PyList\_Append(dllParams, PyInt\_FromLong(phaseINT));
267         PyList\_Append(dllParams, PyInt\_FromLong(locSel));
268         PyList\_Append(dllParams, PyInt\_FromLong(lvdsOEn));
269 
270         \hyperlink{classObject_a644fd329ea4cb85f54fa6846484b84a8}{info}(\textcolor{stringliteral}{"Delay Line Channel <"}+\hyperlink{Tools_8h_af330027dbdafb9a30768b3613c553e60}{itos}(ch)+\textcolor{stringliteral}{"> configuration (@SPI = 0x"}+
      \hyperlink{classICECALv3_a04b02e583f191bfce34d05132cd23834}{itohs}(spiAddr)+\textcolor{stringliteral}{"):"},\textcolor{stringliteral}{"ICECALv3::getDelayLine"});
271         \hyperlink{classObject_a644fd329ea4cb85f54fa6846484b84a8}{info}(\textcolor{stringliteral}{"   ·Phase ADC          : "}+\hyperlink{Tools_8h_af330027dbdafb9a30768b3613c553e60}{itos}(phaseADC),\textcolor{stringliteral}{"ICECALv3::getDelayLine"});
272         \hyperlink{classObject_a644fd329ea4cb85f54fa6846484b84a8}{info}(\textcolor{stringliteral}{"   ·Phase T&H          : "}+\hyperlink{Tools_8h_af330027dbdafb9a30768b3613c553e60}{itos}(phaseTH) ,\textcolor{stringliteral}{"ICECALv3::getDelayLine"});
273         \hyperlink{classObject_a644fd329ea4cb85f54fa6846484b84a8}{info}(\textcolor{stringliteral}{"   ·Phase INT          : "}+\hyperlink{Tools_8h_af330027dbdafb9a30768b3613c553e60}{itos}(phaseINT),\textcolor{stringliteral}{"ICECALv3::getDelayLine"});
274         \hyperlink{classObject_a644fd329ea4cb85f54fa6846484b84a8}{info}(\textcolor{stringliteral}{"   ·LVDS Current Sel   : "}+\hyperlink{Tools_8h_af330027dbdafb9a30768b3613c553e60}{itos}(locSel)  ,\textcolor{stringliteral}{"ICECALv3::getDelayLine"});
275         \hyperlink{classObject_a644fd329ea4cb85f54fa6846484b84a8}{info}(\textcolor{stringliteral}{"   ·LVDS Output enable : "}+\hyperlink{Tools_8h_af330027dbdafb9a30768b3613c553e60}{itos}(lvdsOEn) ,\textcolor{stringliteral}{"ICECALv3::getDelayLine"});
276     \}
277     \textcolor{keywordflow}{return} dllParams;
278 \}
\end{DoxyCode}
\mbox{\Hypertarget{classICECALv3_a4a414d23c1e199b446dc876161338148}\label{classICECALv3_a4a414d23c1e199b446dc876161338148}} 
\index{I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}!get\+Main\+Reg@{get\+Main\+Reg}}
\index{get\+Main\+Reg@{get\+Main\+Reg}!I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}}
\subsubsection{\texorpdfstring{get\+Main\+Reg()}{getMainReg()}}
{\footnotesize\ttfamily Py\+Object $\ast$ I\+C\+E\+C\+A\+Lv3\+::get\+Main\+Reg (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 415 of file I\+C\+E\+C\+A\+Lv3.\+cpp.



References err, icecal\+Main\+Addr, Object\+::info(), itohs(), itos(), and spi\+Read().



Referenced by B\+O\+O\+S\+T\+\_\+\+P\+Y\+T\+H\+O\+N\+\_\+\+M\+O\+D\+U\+L\+E(), and dump\+Config().


\begin{DoxyCode}
416 \{                            
417     \hyperlink{ICECALv3_8h_adf928e51a60dba0df29d615401cc55a8}{U16} rxD[4];
418 
419     \textcolor{keywordtype}{int} vCtlOE, bxidSynOE, clkRefreshEn, iBiasOB, iBiasCETH, iBiasTH, iBiasINT;
420     \textcolor{keywordtype}{int} iBiasCEINT, iBiasCEPZ, iBias0T, iBiasPZ, iBiasV0T;
421     PyObject* icecalMainParams = PyList\_New(0);
422 
423     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<4;i++) rxD[i] = \hyperlink{classICECALv3_aced41ce20a0853d6248b8df88412e57a}{spiRead}(\hyperlink{ICECALv3_8h_a9c22ae782814495416dc2b803df326c1}{icecalMainAddr}[i]);      \textcolor{comment}{//4 registers of 16
       bits.}
424 
425     \textcolor{keywordflow}{if}(\hyperlink{classICECALv3_ad8989925ee5b3ff322d863ce6aaff0bd}{err}) PyList\_Append(icecalMainParams, PyInt\_FromLong(-1));
426     \textcolor{keywordflow}{else}
427     \{
428         \textcolor{comment}{//Delay Line & Slow Control main configuration bits.}
429         vCtlOE              = !((rxD[3] >> 15) & 0x01);     \textcolor{comment}{//1 bit (active low) (d63).}
430         bxidSynOE           = !((rxD[3] >> 14) & 0x01);     \textcolor{comment}{//1 bit (active low) (d62).}
431         clkRefreshEn    = !((rxD[3] >> 13) & 0x01);     \textcolor{comment}{//1 bit (active low) (d61).}
432 
433         \textcolor{comment}{//Bias currents for the analog channels.}
434         iBiasOB             = (rxD[3] >> 6) & 0x3F;     \textcolor{comment}{//6 bits (d59..54).}
435         iBiasCETH           = (rxD[3])          & 0x3F;     \textcolor{comment}{//6 bits (d53..48).}
436         iBiasTH             = (rxD[2] >> 6) & 0x3F;     \textcolor{comment}{//6 bits (d43..38).}
437         iBiasINT            = (rxD[2] )         & 0x3F;     \textcolor{comment}{//6 bits (d37..32).}
438         iBiasCEINT      =((rxD[1] >> 9) & 0x38) | ((rxD[0] >> 12) & 0x7);       \textcolor{comment}{//6 bits (d30..28,
       d14..12).}
439         iBiasCEPZ           = (rxD[1] >> 6) & 0x3F;     \textcolor{comment}{//6 bits (d27..22).}
440         iBias0T             = (rxD[1])          & 0x3F;     \textcolor{comment}{//6 bits (d21..16).}
441         iBiasPZ             = (rxD[0] >> 6) & 0x3F;     \textcolor{comment}{//6 bits (d11..06).}
442         iBiasV0T            = (rxD[0])          & 0x3F;     \textcolor{comment}{//6 bits (d05..00).}
443 
444         PyList\_Append(icecalMainParams, PyInt\_FromLong(vCtlOE));
445         PyList\_Append(icecalMainParams, PyInt\_FromLong(bxidSynOE));
446         PyList\_Append(icecalMainParams, PyInt\_FromLong(clkRefreshEn));
447         PyList\_Append(icecalMainParams, PyInt\_FromLong(iBiasOB));
448         PyList\_Append(icecalMainParams, PyInt\_FromLong(iBiasCETH));
449         PyList\_Append(icecalMainParams, PyInt\_FromLong(iBiasTH));
450         PyList\_Append(icecalMainParams, PyInt\_FromLong(iBiasINT));
451         PyList\_Append(icecalMainParams, PyInt\_FromLong(iBiasCEINT));
452         PyList\_Append(icecalMainParams, PyInt\_FromLong(iBiasCEPZ));
453         PyList\_Append(icecalMainParams, PyInt\_FromLong(iBias0T));
454         PyList\_Append(icecalMainParams, PyInt\_FromLong(iBiasPZ));
455         PyList\_Append(icecalMainParams, PyInt\_FromLong(iBiasV0T));
456 
457         \hyperlink{classObject_a644fd329ea4cb85f54fa6846484b84a8}{info}(\textcolor{stringliteral}{"ICECAL Main Register (@SPI = [0x"}+\hyperlink{classICECALv3_a04b02e583f191bfce34d05132cd23834}{itohs}(\hyperlink{ICECALv3_8h_a9c22ae782814495416dc2b803df326c1}{icecalMainAddr}[3])+\textcolor{stringliteral}{"..0x"}+
      \hyperlink{classICECALv3_a04b02e583f191bfce34d05132cd23834}{itohs}(\hyperlink{ICECALv3_8h_a9c22ae782814495416dc2b803df326c1}{icecalMainAddr}[0])+\textcolor{stringliteral}{"]):"},\textcolor{stringliteral}{"ICECALv3::getIcecalMain"});
458         \hyperlink{classObject_a644fd329ea4cb85f54fa6846484b84a8}{info}(\textcolor{stringliteral}{"   ·DLL Control Voltage Output Enable: "} + \hyperlink{Tools_8h_af330027dbdafb9a30768b3613c553e60}{itos}(vCtlOE)               ,\textcolor{stringliteral}{"
      ICECALv3::getIcecalMain"});
459         \hyperlink{classObject_a644fd329ea4cb85f54fa6846484b84a8}{info}(\textcolor{stringliteral}{"   ·BXID Resynch Output Enable       : "} + \hyperlink{Tools_8h_af330027dbdafb9a30768b3613c553e60}{itos}(bxidSynOE)        ,\textcolor{stringliteral}{"
      ICECALv3::getIcecalMain"});
460         \hyperlink{classObject_a644fd329ea4cb85f54fa6846484b84a8}{info}(\textcolor{stringliteral}{"   ·SPI Clock refresh Enable         : "} + \hyperlink{Tools_8h_af330027dbdafb9a30768b3613c553e60}{itos}(clkRefreshEn) ,\textcolor{stringliteral}{"
      ICECALv3::getIcecalMain"});
461         \hyperlink{classObject_a644fd329ea4cb85f54fa6846484b84a8}{info}(\textcolor{stringliteral}{"   ·Output Buffer bias               : "} + \hyperlink{Tools_8h_af330027dbdafb9a30768b3613c553e60}{itos}(iBiasOB)          ,\textcolor{stringliteral}{"
      ICECALv3::getIcecalMain"});
462         \hyperlink{classObject_a644fd329ea4cb85f54fa6846484b84a8}{info}(\textcolor{stringliteral}{"   ·Track & Hold OpAmp bias (CE)     : "} + \hyperlink{Tools_8h_af330027dbdafb9a30768b3613c553e60}{itos}(iBiasCETH)        ,\textcolor{stringliteral}{"
      ICECALv3::getIcecalMain"});
463         \hyperlink{classObject_a644fd329ea4cb85f54fa6846484b84a8}{info}(\textcolor{stringliteral}{"   ·Track & Hold OpAmp bias          : "} + \hyperlink{Tools_8h_af330027dbdafb9a30768b3613c553e60}{itos}(iBiasTH)          ,\textcolor{stringliteral}{"
      ICECALv3::getIcecalMain"});
464         \hyperlink{classObject_a644fd329ea4cb85f54fa6846484b84a8}{info}(\textcolor{stringliteral}{"   ·Integrator OpAmp bias            : "} + \hyperlink{Tools_8h_af330027dbdafb9a30768b3613c553e60}{itos}(iBiasINT)         ,\textcolor{stringliteral}{"
      ICECALv3::getIcecalMain"});
465         \hyperlink{classObject_a644fd329ea4cb85f54fa6846484b84a8}{info}(\textcolor{stringliteral}{"   ·Integrator OpAmp bias (CE)       : "} + \hyperlink{Tools_8h_af330027dbdafb9a30768b3613c553e60}{itos}(iBiasCEINT)       ,\textcolor{stringliteral}{"
      ICECALv3::getIcecalMain"});
466         \hyperlink{classObject_a644fd329ea4cb85f54fa6846484b84a8}{info}(\textcolor{stringliteral}{"   ·Pole-Zero OpAmp bias (CE)        : "} + \hyperlink{Tools_8h_af330027dbdafb9a30768b3613c553e60}{itos}(iBiasCEPZ)        ,\textcolor{stringliteral}{"
      ICECALv3::getIcecalMain"});
467         \hyperlink{classObject_a644fd329ea4cb85f54fa6846484b84a8}{info}(\textcolor{stringliteral}{"   ·0T bias                    : "} + \hyperlink{Tools_8h_af330027dbdafb9a30768b3613c553e60}{itos}(iBias0T)            ,\textcolor{stringliteral}{"
      ICECALv3::getIcecalMain"});
468         \hyperlink{classObject_a644fd329ea4cb85f54fa6846484b84a8}{info}(\textcolor{stringliteral}{"   ·Pole-Zero OpAmp bias             : "} + \hyperlink{Tools_8h_af330027dbdafb9a30768b3613c553e60}{itos}(iBiasPZ)          ,\textcolor{stringliteral}{"
      ICECALv3::getIcecalMain"});
469         \hyperlink{classObject_a644fd329ea4cb85f54fa6846484b84a8}{info}(\textcolor{stringliteral}{"   ·0T bias (V0T)              : "} + \hyperlink{Tools_8h_af330027dbdafb9a30768b3613c553e60}{itos}(iBiasV0T)           ,\textcolor{stringliteral}{"
      ICECALv3::getIcecalMain"});
470     \}
471     \textcolor{keywordflow}{return} icecalMainParams;
472 \}
\end{DoxyCode}
\mbox{\Hypertarget{classICECALv3_a00e572849b4952e7cf04a39f992df037}\label{classICECALv3_a00e572849b4952e7cf04a39f992df037}} 
\index{I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}!help@{help}}
\index{help@{help}!I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}}
\subsubsection{\texorpdfstring{help()}{help()}}
{\footnotesize\ttfamily void I\+C\+E\+C\+A\+Lv3\+::help (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}

printout help for the element 

Implements \hyperlink{classElement_a32c0de27acb08e17251cef88c3e9303a}{Element}.



Definition at line 104 of file I\+C\+E\+C\+A\+Lv3.\+h.


\begin{DoxyCode}
104 \{ \hyperlink{classObject_a644fd329ea4cb85f54fa6846484b84a8}{info}(\textcolor{stringliteral}{"ICECALv3 "}+\hyperlink{classObject_a300f4c05dd468c7bb8b3c968868443c1}{name}()+\textcolor{stringliteral}{". No help."},\textcolor{stringliteral}{"ICECALv3::help"}); \};
\end{DoxyCode}
\mbox{\Hypertarget{classICECALv3_abf7281fad80b80b70c5b13ce66ba3451}\label{classICECALv3_abf7281fad80b80b70c5b13ce66ba3451}} 
\index{I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}!init@{init}}
\index{init@{init}!I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}}
\subsubsection{\texorpdfstring{init()}{init()}}
{\footnotesize\ttfamily \hyperlink{classStatusCode}{Status\+Code} I\+C\+E\+C\+A\+Lv3\+::init (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}

init the component

\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Implements \hyperlink{classElement_af42754b5cabc198869222725218d695c}{Element}.



Definition at line 111 of file I\+C\+E\+C\+A\+Lv3.\+h.



References shell\+::reset(), and Status\+Code\+::\+S\+U\+C\+C\+E\+SS.


\begin{DoxyCode}
111                     \{
112     \textcolor{keywordflow}{return} \hyperlink{classStatusCode_a6f565cbeadc76d14c72f047e5e85eb4badd0da38d3ba0d922efd1f4619bc37ad8}{StatusCode::SUCCESS};
113   \};
\end{DoxyCode}
\mbox{\Hypertarget{classICECALv3_a04b02e583f191bfce34d05132cd23834}\label{classICECALv3_a04b02e583f191bfce34d05132cd23834}} 
\index{I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}!itohs@{itohs}}
\index{itohs@{itohs}!I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}}
\subsubsection{\texorpdfstring{itohs()}{itohs()}}
{\footnotesize\ttfamily std\+::string I\+C\+E\+C\+A\+Lv3\+::itohs (\begin{DoxyParamCaption}\item[{int}]{value }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Definition at line 164 of file I\+C\+E\+C\+A\+Lv3.\+h.



Referenced by bxid\+Resynch\+Status(), get\+Analog\+Ch(), get\+Delay\+Line\+Ch(), get\+Main\+Reg(), set\+Analog\+Ch(), spi\+Address\+Scan(), spi\+F\+E\+R\+Test(), spi\+Read(), spi\+Write(), and spi\+Write\+Safe().


\begin{DoxyCode}
165     \{
166         \textcolor{keywordtype}{char} buff[32];
167       \textcolor{keywordflow}{if}      (value < 256)   sprintf(buff,\textcolor{stringliteral}{"%02X"},value);
168         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (value < 65536) sprintf(buff,\textcolor{stringliteral}{"%04X"},value);
169         \textcolor{keywordflow}{else}                                    sprintf(buff,\textcolor{stringliteral}{"%08X"},value);
170         \textcolor{keywordflow}{return} std::string(buff);
171     \}
\end{DoxyCode}
\mbox{\Hypertarget{classICECALv3_a514456dd303e897aa1b55dccf3fa66d0}\label{classICECALv3_a514456dd303e897aa1b55dccf3fa66d0}} 
\index{I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}!load\+Config@{load\+Config}}
\index{load\+Config@{load\+Config}!I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}}
\subsubsection{\texorpdfstring{load\+Config()}{loadConfig()}}
{\footnotesize\ttfamily Py\+Object $\ast$ I\+C\+E\+C\+A\+Lv3\+::load\+Config (\begin{DoxyParamCaption}\item[{string}]{config\+File }\end{DoxyParamCaption})}



Definition at line 36 of file I\+C\+E\+C\+A\+Lv3.\+cpp.



References fill\+Params(), parse\+Parameter\+List(), set\+Analog\+Ch(), set\+Delay\+Line\+Ch(), and set\+Main\+Reg().



Referenced by B\+O\+O\+S\+T\+\_\+\+P\+Y\+T\+H\+O\+N\+\_\+\+M\+O\+D\+U\+L\+E().


\begin{DoxyCode}
37 \{
38     \textcolor{keywordtype}{string} paramName[64];
39     \textcolor{keywordtype}{int} paramValue[64], nParams;
40     PyObject* asicParams;
41 
42     PyObject* fullConfiguration = PyList\_New(0);
43     \textcolor{comment}{//These are the names of the parameters that we are looking for in each case.}
44     \textcolor{keywordtype}{string} mainParams[] = \{\textcolor{stringliteral}{"VCONTROL\_OE"},\textcolor{stringliteral}{"BXID\_SYN\_OE"},\textcolor{stringliteral}{"CLK\_REFRESH"},\textcolor{stringliteral}{"IBIAS\_OB"},\textcolor{stringliteral}{"IBIAS\_CE\_TH"},\textcolor{stringliteral}{"IBIAS\_TH"},\textcolor{stringliteral}{"
      IBIAS\_INT"},\textcolor{stringliteral}{"IBIAS\_CE\_IN"},\textcolor{stringliteral}{"IBIAS\_CE\_PZ"},\textcolor{stringliteral}{"IBIAS\_0T"},\textcolor{stringliteral}{"IBIAS\_PZ"},\textcolor{stringliteral}{"IBIAS\_V0T"}\};
45     \textcolor{keywordtype}{string} analogParams[4][7]=      \{ \{\textcolor{stringliteral}{"CINT\_SUBCH0[0]"},\textcolor{stringliteral}{"CINT\_SUBCH1[0]"},\textcolor{stringliteral}{"IOFF\_SUBCH0[0]"},\textcolor{stringliteral}{"IOFF\_SUBCH1[0]"},\textcolor{stringliteral}{
      "ZERO[0]"},\textcolor{stringliteral}{"POLE[0]"},\textcolor{stringliteral}{"ZIN[0]"}\}
46                                                                 , \{\textcolor{stringliteral}{"CINT\_SUBCH0[1]"},\textcolor{stringliteral}{"CINT\_SUBCH1[1]"},\textcolor{stringliteral}{"
      IOFF\_SUBCH0[1]"},\textcolor{stringliteral}{"IOFF\_SUBCH1[1]"},\textcolor{stringliteral}{"ZERO[1]"},\textcolor{stringliteral}{"POLE[1]"},\textcolor{stringliteral}{"ZIN[1]"}\}
47                                                                 , \{\textcolor{stringliteral}{"CINT\_SUBCH0[2]"},\textcolor{stringliteral}{"CINT\_SUBCH1[2]"},\textcolor{stringliteral}{"
      IOFF\_SUBCH0[2]"},\textcolor{stringliteral}{"IOFF\_SUBCH1[2]"},\textcolor{stringliteral}{"ZERO[2]"},\textcolor{stringliteral}{"POLE[2]"},\textcolor{stringliteral}{"ZIN[2]"}\}
48                                                                 , \{\textcolor{stringliteral}{"CINT\_SUBCH0[3]"},\textcolor{stringliteral}{"CINT\_SUBCH1[3]"},\textcolor{stringliteral}{"
      IOFF\_SUBCH0[3]"},\textcolor{stringliteral}{"IOFF\_SUBCH1[3]"},\textcolor{stringliteral}{"ZERO[3]"},\textcolor{stringliteral}{"POLE[3]"},\textcolor{stringliteral}{"ZIN[3]"}\}             \};
49     \textcolor{keywordtype}{string} delayLineParams[4][5]= \{ \{\textcolor{stringliteral}{"PHASE\_ADC[0]"},\textcolor{stringliteral}{"PHASE\_TH[0]"},\textcolor{stringliteral}{"PHASE\_INT[0]"},\textcolor{stringliteral}{"LOC\_SEL[0]"},\textcolor{stringliteral}{"LVDS\_OEN[0]"}
      \}
50                                                                 ,\{\textcolor{stringliteral}{"PHASE\_ADC[1]"},\textcolor{stringliteral}{"PHASE\_TH[1]"},\textcolor{stringliteral}{"
      PHASE\_INT[1]"},\textcolor{stringliteral}{"LOC\_SEL[1]"},\textcolor{stringliteral}{"LVDS\_OEN[1]"}\}
51                                                                 ,\{\textcolor{stringliteral}{"PHASE\_ADC[2]"},\textcolor{stringliteral}{"PHASE\_TH[2]"},\textcolor{stringliteral}{"
      PHASE\_INT[2]"},\textcolor{stringliteral}{"LOC\_SEL[2]"},\textcolor{stringliteral}{"LVDS\_OEN[2]"}\}
52                                                                 ,\{\textcolor{stringliteral}{"PHASE\_ADC[3]"},\textcolor{stringliteral}{"PHASE\_TH[3]"},\textcolor{stringliteral}{"
      PHASE\_INT[3]"},\textcolor{stringliteral}{"LOC\_SEL[3]"},\textcolor{stringliteral}{"LVDS\_OEN[3]"}\}               \};
53 
54     nParams = \hyperlink{classICECALv3_a313e8166af1ce26b4026f883ad900fb9}{parseParameterList}(configFile, paramName, paramValue);
55 
56     \textcolor{keywordflow}{if}(nParams != -1)
57     \{
58         \textcolor{comment}{//At this point we have an array of parameter names (string) and an array of values (int).}
59         \textcolor{comment}{//We obtain the parameter values of the 'mainParams' array by searching on the C++ dictionary.}
60         asicParams = \hyperlink{classICECALv3_ac006abc42a048308427f6801d783a407}{fillParams}(mainParams,12,paramName,paramValue,nParams);
61         \hyperlink{classICECALv3_a479f7e17669da4b785af840049d39cb4}{setMainReg}(asicParams);
62         PyList\_Append(fullConfiguration,asicParams);
63 
64         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} iCh=0 ; iCh<4 ; iCh++)
65         \{
66             asicParams = \hyperlink{classICECALv3_ac006abc42a048308427f6801d783a407}{fillParams}(analogParams[iCh],7,paramName,paramValue,nParams);            \textcolor{comment}{
      //Parameters of the analog channel.}
67             \hyperlink{classICECALv3_a9578e4d13c250d8bc417f68c79d6a21d}{setAnalogCh}(iCh,asicParams);
68             PyList\_Append(fullConfiguration,asicParams);
69             asicParams = \hyperlink{classICECALv3_ac006abc42a048308427f6801d783a407}{fillParams}(delayLineParams[iCh],5,paramName,paramValue,nParams);     \textcolor{comment}{//
      Parameters of the delay line channel.}
70             \hyperlink{classICECALv3_a14a7a29c9a3412c062f053cc616b860a}{setDelayLineCh}(iCh,asicParams);       
71             PyList\_Append(fullConfiguration,asicParams);
72         \}
73     \}
74     \textcolor{keywordflow}{return} fullConfiguration;
75 \}
\end{DoxyCode}
\mbox{\Hypertarget{classICECALv3_a313e8166af1ce26b4026f883ad900fb9}\label{classICECALv3_a313e8166af1ce26b4026f883ad900fb9}} 
\index{I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}!parse\+Parameter\+List@{parse\+Parameter\+List}}
\index{parse\+Parameter\+List@{parse\+Parameter\+List}!I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}}
\subsubsection{\texorpdfstring{parse\+Parameter\+List()}{parseParameterList()}}
{\footnotesize\ttfamily int I\+C\+E\+C\+A\+Lv3\+::parse\+Parameter\+List (\begin{DoxyParamCaption}\item[{string}]{config\+File,  }\item[{string}]{param\+Name\mbox{[}64\mbox{]},  }\item[{int}]{param\+Value\mbox{[}64\mbox{]} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 77 of file I\+C\+E\+C\+A\+Lv3.\+cpp.



References Object\+::error().



Referenced by load\+Config().


\begin{DoxyCode}
78 \{
79     \textcolor{keywordtype}{int} iParams = 0, eqPos;
80     \textcolor{keywordtype}{string} line;    
81 
82     std::ifstream fd(configFile.c\_str());
83     \textcolor{keywordflow}{if}(!fd)                                 \textcolor{comment}{//File NOT OK.}
84     \{
85         \hyperlink{classObject_a204a95f57818c0f811933917a30eff45}{error}(configFile+\textcolor{stringliteral}{" could not be opened."},\textcolor{stringliteral}{"ICECALv3::loadConfig"});
86         \textcolor{keywordflow}{return} -1;
87   \}
88     \textcolor{keywordflow}{else}                                        \textcolor{comment}{//File OK.}
89     \{
90         \textcolor{keywordflow}{while}(!fd.eof())                                    
91         \{
92             getline(fd,line);
93             eqPos = line.find(\textcolor{stringliteral}{"="});
94             \textcolor{keywordflow}{if}((eqPos != string::npos) && (line[0] != \textcolor{charliteral}{'#'}))     \textcolor{comment}{//If current line contains "=" and DO NOT
       start with "#", is a good parameter.}
95             \{
96                 paramName[iParams]  = line.substr(0,eqPos);                                                         \textcolor{comment}{
      //We store the parameter name}
97                 paramValue[iParams] = atoi(line.substr(eqPos+1,string::npos).c\_str());  \textcolor{comment}{//and the parameter
       value.}
98                 iParams++;
99             \}
100         \}
101         \textcolor{keywordflow}{return} iParams;
102     \}
103 \}
\end{DoxyCode}
\mbox{\Hypertarget{classICECALv3_a33afc7c8e0f399336152abd03cbe8d1b}\label{classICECALv3_a33afc7c8e0f399336152abd03cbe8d1b}} 
\index{I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}!reset@{reset}}
\index{reset@{reset}!I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}}
\subsubsection{\texorpdfstring{reset()}{reset()}}
{\footnotesize\ttfamily void I\+C\+E\+C\+A\+Lv3\+::reset (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Resets the \hyperlink{classElement}{Element} so that is is in a standard and safe situation. Different from \hyperlink{classElement_af42754b5cabc198869222725218d695c}{Element\+::init} which configure the \hyperlink{classElement}{Element}. \hyperlink{classElement_a69efffa22f06909d768149715565cb56}{Element\+::reset()} is more an Emergency pull. It is often/usually called by the recursive\+Init\+Element method at the start of the program. 

Implements \hyperlink{classElement_a69efffa22f06909d768149715565cb56}{Element}.



Definition at line 655 of file I\+C\+E\+C\+A\+Lv3.\+cpp.


\begin{DoxyCode}
655                     \{
656 
657 \}
\end{DoxyCode}
\mbox{\Hypertarget{classICECALv3_a1b9ca0e09d45634a70da6f19a7257314}\label{classICECALv3_a1b9ca0e09d45634a70da6f19a7257314}} 
\index{I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}!reset\+Pumps@{reset\+Pumps}}
\index{reset\+Pumps@{reset\+Pumps}!I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}}
\subsubsection{\texorpdfstring{reset\+Pumps()}{resetPumps()}}
{\footnotesize\ttfamily void I\+C\+E\+C\+A\+Lv3\+::reset\+Pumps (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line 69 of file I\+C\+E\+C\+A\+Lv3.\+h.



References S\+C\+\_\+\+S\+O\+F\+T\+\_\+\+R\+ST.


\begin{DoxyCode}
69 \{                                       \hyperlink{classICECALv3_aef00f02801dea4bda2093c930501dcdd}{spiWrite}(\hyperlink{ICECALv3_8h_adfc33152f992de37ef835a719df6c934}{SC\_SOFT\_RST},0);                                 
      \};
\end{DoxyCode}
\mbox{\Hypertarget{classICECALv3_aaf38119f47401a85022ae1b0d05675bd}\label{classICECALv3_aaf38119f47401a85022ae1b0d05675bd}} 
\index{I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}!set\+Address@{set\+Address}}
\index{set\+Address@{set\+Address}!I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}}
\subsubsection{\texorpdfstring{set\+Address()}{setAddress()}}
{\footnotesize\ttfamily void I\+C\+E\+C\+A\+Lv3\+::set\+Address (\begin{DoxyParamCaption}\item[{\hyperlink{ICECALv3_8h_a3cb25ca6f51f003950f9625ff05536fc}{U8}}]{address }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line 65 of file I\+C\+E\+C\+A\+Lv3.\+h.



Referenced by B\+O\+O\+S\+T\+\_\+\+P\+Y\+T\+H\+O\+N\+\_\+\+M\+O\+D\+U\+L\+E().


\begin{DoxyCode}
65 \{   \hyperlink{classICECALv3_a6e8b6c03f5b0f1d8281bf8a0fa46064f}{confReg}->\hyperlink{classIOobject_ae0d372aaeafe3da3c239677118deb2ac}{setAddress}(address);   \}
\end{DoxyCode}
\mbox{\Hypertarget{classICECALv3_a9578e4d13c250d8bc417f68c79d6a21d}\label{classICECALv3_a9578e4d13c250d8bc417f68c79d6a21d}} 
\index{I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}!set\+Analog\+Ch@{set\+Analog\+Ch}}
\index{set\+Analog\+Ch@{set\+Analog\+Ch}!I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}}
\subsubsection{\texorpdfstring{set\+Analog\+Ch()}{setAnalogCh()}}
{\footnotesize\ttfamily \hyperlink{classStatusCode}{Status\+Code} I\+C\+E\+C\+A\+Lv3\+::set\+Analog\+Ch (\begin{DoxyParamCaption}\item[{int}]{ch,  }\item[{Py\+Object $\ast$}]{icecal\+Ch\+Params }\end{DoxyParamCaption})}



Definition at line 361 of file I\+C\+E\+C\+A\+Lv3.\+cpp.



References err, Object\+::error(), Status\+Code\+::\+F\+A\+I\+L\+U\+RE, icecal\+L\+S\+B\+Addr\+Ch, icecal\+M\+S\+B\+Addr\+Ch, itohs(), spi\+Write\+Safe(), and Status\+Code\+::\+S\+U\+C\+C\+E\+SS.



Referenced by B\+O\+O\+S\+T\+\_\+\+P\+Y\+T\+H\+O\+N\+\_\+\+M\+O\+D\+U\+L\+E(), and load\+Config().


\begin{DoxyCode}
362 \{                            
363     \hyperlink{ICECALv3_8h_adf928e51a60dba0df29d615401cc55a8}{U16} hTx, lTx;
364     \textcolor{keywordtype}{int} cIntMsb, cIntLsb0, cIntLsb1, cIntSubCh0, cIntSubCh1, iOffMsb, iOffLsb0, iOffLsb1;
365     \textcolor{keywordtype}{int} iOffSubCh0, iOffSubCh1, zero, pole, zIn;
366 
367     \hyperlink{ICECALv3_8h_a3cb25ca6f51f003950f9625ff05536fc}{U8} spiLsbAddr = \hyperlink{ICECALv3_8h_abd124f50fa794b9b0aded801fabf5322}{icecalLSBAddrCh}[ch];           \textcolor{comment}{//The SPI address of the 16 LSBs.}
368     \hyperlink{ICECALv3_8h_a3cb25ca6f51f003950f9625ff05536fc}{U8} spiMsbAddr = \hyperlink{ICECALv3_8h_afba64a649cc9314882fd49b62b99d6e7}{icecalMSBAddrCh}[ch];           \textcolor{comment}{//The SPI address of the 16 MSBs.}
369 
370     cIntSubCh0 = PyInt\_AsLong(PyList\_GetItem(icecalChParams,0));
371     cIntSubCh1 = PyInt\_AsLong(PyList\_GetItem(icecalChParams,1));
372     iOffSubCh0 = PyInt\_AsLong(PyList\_GetItem(icecalChParams,2));
373     iOffSubCh1 = PyInt\_AsLong(PyList\_GetItem(icecalChParams,3));
374     zero             = PyInt\_AsLong(PyList\_GetItem(icecalChParams,4));
375     pole             = PyInt\_AsLong(PyList\_GetItem(icecalChParams,5));
376     zIn              = PyInt\_AsLong(PyList\_GetItem(icecalChParams,6));
377 
378     \textcolor{comment}{//Integretor Capacitor and Offset current configuration registers share the MSBs between subchannels.}
379     \textcolor{comment}{//Therefore, these MSBs must be equal. Otherwise registers won't be properly configured. }
380     \textcolor{keywordflow}{if}(((cIntSubCh0 & 0x18) == (cIntSubCh1 & 0x18)) && ((iOffSubCh0 & 0x3C) == (iOffSubCh1 & 0x3C)))
381     \{
382         \textcolor{comment}{//Integretor capacitor: 2 + 3 bits.}
383         cIntMsb  = (cIntSubCh0 >> 3) & 0x3;
384         cIntLsb0 =  cIntSubCh0 & 0x7;
385         cIntLsb1 =  cIntSubCh1 & 0x7;
386         \textcolor{comment}{//Offset current: 4 + 2 bits.}
387         iOffMsb  = (iOffSubCh0 >> 2) & 0xF;
388         iOffLsb0 =  iOffSubCh0 & 0x3;
389         iOffLsb1 =  iOffSubCh1 & 0x3;
390 
391         hTx =  ((cIntMsb & 0x3) << 14) | ((cIntLsb0 & 0x7) << 11) | ((cIntLsb1 & 0x7) << 8) | 
392                      ((iOffMsb & 0xF) << 4)  | ((iOffLsb0 & 0x3) << 2)  | ((iOffLsb1 & 0x3));
393         lTx =    ((zero & 0x1F) << 11)   | ((pole & 0x3F) << 5)     | (zIn & 0x1F);
394 
395                             \hyperlink{classICECALv3_ad8989925ee5b3ff322d863ce6aaff0bd}{err} = \hyperlink{classICECALv3_aa0b8358ea0be8e47a8aded5e1551787f}{spiWriteSafe}(spiMsbAddr,hTx);  
396         \textcolor{keywordflow}{if}(!\hyperlink{classICECALv3_ad8989925ee5b3ff322d863ce6aaff0bd}{err}) \hyperlink{classICECALv3_ad8989925ee5b3ff322d863ce6aaff0bd}{err} = \hyperlink{classICECALv3_aa0b8358ea0be8e47a8aded5e1551787f}{spiWriteSafe}(spiLsbAddr,lTx);
397 
398         \textcolor{keywordflow}{if}(\hyperlink{classICECALv3_ad8989925ee5b3ff322d863ce6aaff0bd}{err}) \textcolor{keywordflow}{return} \hyperlink{classStatusCode_a6f565cbeadc76d14c72f047e5e85eb4ba3da73d4c469762eb9d3c960368252b26}{StatusCode::FAILURE};
399         \textcolor{keywordflow}{else}        \textcolor{keywordflow}{return} \hyperlink{classStatusCode_a6f565cbeadc76d14c72f047e5e85eb4badd0da38d3ba0d922efd1f4619bc37ad8}{StatusCode::SUCCESS};
400     \}
401     \textcolor{keywordflow}{else} 
402     \{
403         \textcolor{keywordflow}{if}((cIntSubCh0 & 0x18) != (cIntSubCh1 & 0x18)) \hyperlink{classObject_a204a95f57818c0f811933917a30eff45}{error}(\textcolor{stringliteral}{"Integrator Cap MSB sub-channel mismatch.
       MSB<0> = "}+\hyperlink{classICECALv3_a04b02e583f191bfce34d05132cd23834}{itohs}(cIntSubCh0)+\textcolor{stringliteral}{", MSB<1> = "}+\hyperlink{classICECALv3_a04b02e583f191bfce34d05132cd23834}{itohs}(cIntSubCh1)+\textcolor{stringliteral}{"."},\textcolor{stringliteral}{"ICECALv3::setAnalogCh"});
404         \textcolor{keywordflow}{if}((iOffSubCh0 & 0x3C) != (iOffSubCh1 & 0x3C)) \hyperlink{classObject_a204a95f57818c0f811933917a30eff45}{error}(\textcolor{stringliteral}{"Offset Current MSB sub-channel mismatch.
       MSB<0> = "}+\hyperlink{classICECALv3_a04b02e583f191bfce34d05132cd23834}{itohs}(iOffSubCh0)+\textcolor{stringliteral}{", MSB<1> = "}+\hyperlink{classICECALv3_a04b02e583f191bfce34d05132cd23834}{itohs}(iOffSubCh1)+\textcolor{stringliteral}{"."},\textcolor{stringliteral}{"ICECALv3::setAnalogCh"});
405         \textcolor{keywordflow}{return} \hyperlink{classStatusCode_a6f565cbeadc76d14c72f047e5e85eb4ba3da73d4c469762eb9d3c960368252b26}{StatusCode::FAILURE};
406     \}
407 \}
\end{DoxyCode}
\mbox{\Hypertarget{classICECALv3_a14a7a29c9a3412c062f053cc616b860a}\label{classICECALv3_a14a7a29c9a3412c062f053cc616b860a}} 
\index{I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}!set\+Delay\+Line\+Ch@{set\+Delay\+Line\+Ch}}
\index{set\+Delay\+Line\+Ch@{set\+Delay\+Line\+Ch}!I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}}
\subsubsection{\texorpdfstring{set\+Delay\+Line\+Ch()}{setDelayLineCh()}}
{\footnotesize\ttfamily \hyperlink{classStatusCode}{Status\+Code} I\+C\+E\+C\+A\+Lv3\+::set\+Delay\+Line\+Ch (\begin{DoxyParamCaption}\item[{int}]{ch,  }\item[{Py\+Object $\ast$}]{dll\+Params }\end{DoxyParamCaption})}



Definition at line 281 of file I\+C\+E\+C\+A\+Lv3.\+cpp.



References delay\+Line\+Addr\+Ch, err, Status\+Code\+::\+F\+A\+I\+L\+U\+RE, spi\+Write\+Safe(), and Status\+Code\+::\+S\+U\+C\+C\+E\+SS.



Referenced by B\+O\+O\+S\+T\+\_\+\+P\+Y\+T\+H\+O\+N\+\_\+\+M\+O\+D\+U\+L\+E(), and load\+Config().


\begin{DoxyCode}
282 \{                            
283     \hyperlink{ICECALv3_8h_adf928e51a60dba0df29d615401cc55a8}{U16} txData;
284     \textcolor{keywordtype}{int} phaseADC, phaseTH, phaseINT, locSel, lvdsOEn;
285 
286     \hyperlink{ICECALv3_8h_a3cb25ca6f51f003950f9625ff05536fc}{U8} spiAddr = \hyperlink{ICECALv3_8h_a848408b773702d268053cb49d205e097}{delayLineAddrCh}[ch];          \textcolor{comment}{//The SPI address of this delay line
       channel.}
287 
288     \textcolor{comment}{//Converts the elements of the PyList to integers.}
289     phaseADC = PyInt\_AsLong(PyList\_GetItem(dllParams,0));
290     phaseTH  = PyInt\_AsLong(PyList\_GetItem(dllParams,1));
291     phaseINT = PyInt\_AsLong(PyList\_GetItem(dllParams,2));
292     locSel   = PyInt\_AsLong(PyList\_GetItem(dllParams,3));
293     lvdsOEn  = PyInt\_AsLong(PyList\_GetItem(dllParams,4));
294 
295     \textcolor{comment}{//txData contains the 16 bits corresponding to the delay line channel.}
296     txData =  ((phaseADC & 0x1F) << 11) | ((phaseTH & 0x1F) << 6) | ((phaseINT & 0x1F) << 3) | ((locSel & 
      0x03) << 1) | (lvdsOEn & 0x01);
297 
298     \textcolor{comment}{//Data is sent and checked. If there is a random write/read error, data is written again.}
299     \hyperlink{classICECALv3_ad8989925ee5b3ff322d863ce6aaff0bd}{err} = \hyperlink{classICECALv3_aa0b8358ea0be8e47a8aded5e1551787f}{spiWriteSafe}(spiAddr,txData);  
300 
301     \textcolor{keywordflow}{if}(\hyperlink{classICECALv3_ad8989925ee5b3ff322d863ce6aaff0bd}{err}) \textcolor{keywordflow}{return} \hyperlink{classStatusCode_a6f565cbeadc76d14c72f047e5e85eb4ba3da73d4c469762eb9d3c960368252b26}{StatusCode::FAILURE};
302     \textcolor{keywordflow}{else}        \textcolor{keywordflow}{return} \hyperlink{classStatusCode_a6f565cbeadc76d14c72f047e5e85eb4badd0da38d3ba0d922efd1f4619bc37ad8}{StatusCode::SUCCESS};
303 \}
\end{DoxyCode}
\mbox{\Hypertarget{classICECALv3_a479f7e17669da4b785af840049d39cb4}\label{classICECALv3_a479f7e17669da4b785af840049d39cb4}} 
\index{I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}!set\+Main\+Reg@{set\+Main\+Reg}}
\index{set\+Main\+Reg@{set\+Main\+Reg}!I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}}
\subsubsection{\texorpdfstring{set\+Main\+Reg()}{setMainReg()}}
{\footnotesize\ttfamily \hyperlink{classStatusCode}{Status\+Code} I\+C\+E\+C\+A\+Lv3\+::set\+Main\+Reg (\begin{DoxyParamCaption}\item[{Py\+Object $\ast$}]{icecal\+Main\+Params }\end{DoxyParamCaption})}



Definition at line 474 of file I\+C\+E\+C\+A\+Lv3.\+cpp.



References err, Status\+Code\+::\+F\+A\+I\+L\+U\+RE, icecal\+Main\+Addr, spi\+Write\+Safe(), and Status\+Code\+::\+S\+U\+C\+C\+E\+SS.



Referenced by B\+O\+O\+S\+T\+\_\+\+P\+Y\+T\+H\+O\+N\+\_\+\+M\+O\+D\+U\+L\+E(), and load\+Config().


\begin{DoxyCode}
475 \{                            
476     \hyperlink{ICECALv3_8h_adf928e51a60dba0df29d615401cc55a8}{U16} txD[4];
477 
478     \textcolor{keywordtype}{int} vCtlOE, bxidSynOE, clkRefreshEn, iBiasOB, iBiasCETH, iBiasTH, iBiasINT;
479     \textcolor{keywordtype}{int} iBiasCEINT, iBiasCEPZ, iBias0T, iBiasPZ, iBiasV0T;
480     
481     vCtlOE              = !PyInt\_AsLong(PyList\_GetItem(icecalMainParams,0));    \textcolor{comment}{//Active low.}
482     bxidSynOE       = !PyInt\_AsLong(PyList\_GetItem(icecalMainParams,1));    \textcolor{comment}{//Active low.}
483     clkRefreshEn    = !PyInt\_AsLong(PyList\_GetItem(icecalMainParams,2));    \textcolor{comment}{//Active low.}
484     iBiasOB         = PyInt\_AsLong(PyList\_GetItem(icecalMainParams,3));
485     iBiasCETH           = PyInt\_AsLong(PyList\_GetItem(icecalMainParams,4));
486     iBiasTH             = PyInt\_AsLong(PyList\_GetItem(icecalMainParams,5));
487     iBiasINT            = PyInt\_AsLong(PyList\_GetItem(icecalMainParams,6));
488     iBiasCEINT      = PyInt\_AsLong(PyList\_GetItem(icecalMainParams,7));
489     iBiasCEPZ       = PyInt\_AsLong(PyList\_GetItem(icecalMainParams,8));
490     iBias0T             = PyInt\_AsLong(PyList\_GetItem(icecalMainParams,9));
491     iBiasPZ             = PyInt\_AsLong(PyList\_GetItem(icecalMainParams,10));
492     iBiasV0T        = PyInt\_AsLong(PyList\_GetItem(icecalMainParams,11));
493 
494     txD[3] = ((vCtlOE & 0x1) << 15)         | ((bxidSynOE & 0x1) << 14) | ((clkRefreshEn & 0x1) << 13) | ((
      iBiasOB & 0x3F) << 6) | (iBiasCETH & 0x3F);
495     txD[2] = ((iBiasTH & 0x3F) << 6)        |  (iBiasINT  & 0x3F); 
496     txD[1] = ((iBiasCEINT & 0x38) << 9) | ((iBiasCEPZ & 0x3F) << 6) |  (iBias0T      & 0x3F);
497     txD[0] = ((iBiasCEINT & 0x7) << 12) | ((iBiasPZ   & 0x3F) << 6) |  (iBiasV0T     & 0x3F);
498 
499     \textcolor{comment}{//Four 16-bit registers are written.}
500     \hyperlink{classICECALv3_ad8989925ee5b3ff322d863ce6aaff0bd}{err} = 0;
501     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<4;i++) \hyperlink{classICECALv3_ad8989925ee5b3ff322d863ce6aaff0bd}{err} |= \hyperlink{classICECALv3_aa0b8358ea0be8e47a8aded5e1551787f}{spiWriteSafe}(\hyperlink{ICECALv3_8h_a9c22ae782814495416dc2b803df326c1}{icecalMainAddr}[i],txD[i]);
502 
503     \textcolor{keywordflow}{if}(\hyperlink{classICECALv3_ad8989925ee5b3ff322d863ce6aaff0bd}{err}) \textcolor{keywordflow}{return} \hyperlink{classStatusCode_a6f565cbeadc76d14c72f047e5e85eb4ba3da73d4c469762eb9d3c960368252b26}{StatusCode::FAILURE};
504     \textcolor{keywordflow}{else}        \textcolor{keywordflow}{return} \hyperlink{classStatusCode_a6f565cbeadc76d14c72f047e5e85eb4badd0da38d3ba0d922efd1f4619bc37ad8}{StatusCode::SUCCESS};
505 \}
\end{DoxyCode}
\mbox{\Hypertarget{classICECALv3_aae0b7539c0bba5311aab99e000d1be6d}\label{classICECALv3_aae0b7539c0bba5311aab99e000d1be6d}} 
\index{I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}!set\+N\+Retries@{set\+N\+Retries}}
\index{set\+N\+Retries@{set\+N\+Retries}!I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}}
\subsubsection{\texorpdfstring{set\+N\+Retries()}{setNRetries()}}
{\footnotesize\ttfamily void I\+C\+E\+C\+A\+Lv3\+::set\+N\+Retries (\begin{DoxyParamCaption}\item[{int}]{n\+Ret }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line 66 of file I\+C\+E\+C\+A\+Lv3.\+h.



Referenced by B\+O\+O\+S\+T\+\_\+\+P\+Y\+T\+H\+O\+N\+\_\+\+M\+O\+D\+U\+L\+E().


\begin{DoxyCode}
66 \{   \hyperlink{classICECALv3_ae877ce34b3a4d6c368cc6409ac9614fa}{nRetries} = nRet;                                \}
\end{DoxyCode}
\mbox{\Hypertarget{classICECALv3_acbf1a7a8510d7e02280bacc58badf4f4}\label{classICECALv3_acbf1a7a8510d7e02280bacc58badf4f4}} 
\index{I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}!spi\+Address\+Scan@{spi\+Address\+Scan}}
\index{spi\+Address\+Scan@{spi\+Address\+Scan}!I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}}
\subsubsection{\texorpdfstring{spi\+Address\+Scan()}{spiAddressScan()}}
{\footnotesize\ttfamily void I\+C\+E\+C\+A\+Lv3\+::spi\+Address\+Scan (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 688 of file I\+C\+E\+C\+A\+Lv3.\+cpp.



References itohs(), itos(), spi\+Read(), and Object\+::warning().



Referenced by B\+O\+O\+S\+T\+\_\+\+P\+Y\+T\+H\+O\+N\+\_\+\+M\+O\+D\+U\+L\+E().


\begin{DoxyCode}
689 \{
690     \hyperlink{ICECALv3_8h_adf928e51a60dba0df29d615401cc55a8}{U16} rxData;
691     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} addr, rw, pumpRst, conf, regSel;
692 
693     \textcolor{keywordflow}{for}(addr=0; addr<256; addr++)
694     \{
695         rw      = (addr>>7);
696         pumpRst = (addr>>6) & 0x01;
697         conf    = (addr>>5) & 0x01;
698         regSel  = addr & 0x1F;
699 
700         rxData = \hyperlink{classICECALv3_aced41ce20a0853d6248b8df88412e57a}{spiRead}( (\hyperlink{ICECALv3_8h_a3cb25ca6f51f003950f9625ff05536fc}{U8}) addr , 0x00 );
701         \hyperlink{classObject_a65cd4fda577711660821fd2cd5a3b4c9}{warning}(\textcolor{stringliteral}{"R/!W="}+\hyperlink{Tools_8h_af330027dbdafb9a30768b3613c553e60}{itos}(rw)+\textcolor{stringliteral}{" PUMPrst="}+\hyperlink{Tools_8h_af330027dbdafb9a30768b3613c553e60}{itos}(pumpRst)+\textcolor{stringliteral}{" !CONF/STAT="}+
      \hyperlink{Tools_8h_af330027dbdafb9a30768b3613c553e60}{itos}(conf)+\textcolor{stringliteral}{" REGsel="}+\hyperlink{Tools_8h_af330027dbdafb9a30768b3613c553e60}{itos}(regSel)+\textcolor{stringliteral}{" ~ SPI(@=0x"}+\hyperlink{classICECALv3_a04b02e583f191bfce34d05132cd23834}{itohs}(addr)+\textcolor{stringliteral}{") = 0x"}+
      \hyperlink{classICECALv3_a04b02e583f191bfce34d05132cd23834}{itohs}(rxData),\textcolor{stringliteral}{"ICECALv3::spiAddressScan"});
702     \}
703 \}
\end{DoxyCode}
\mbox{\Hypertarget{classICECALv3_a8639cf6a44cba85b53128b5e1dc21e15}\label{classICECALv3_a8639cf6a44cba85b53128b5e1dc21e15}} 
\index{I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}!spi\+F\+E\+R\+Test@{spi\+F\+E\+R\+Test}}
\index{spi\+F\+E\+R\+Test@{spi\+F\+E\+R\+Test}!I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}}
\subsubsection{\texorpdfstring{spi\+F\+E\+R\+Test()}{spiFERTest()}}
{\footnotesize\ttfamily Py\+Object $\ast$ I\+C\+E\+C\+A\+Lv3\+::spi\+F\+E\+R\+Test (\begin{DoxyParamCaption}\item[{long}]{n\+Test }\end{DoxyParamCaption})}



Definition at line 577 of file I\+C\+E\+C\+A\+Lv3.\+cpp.



References delay\+Line\+Addr\+Ch, Object\+::error(), icecal\+L\+S\+B\+Addr\+Ch, icecal\+Main\+Addr, icecal\+M\+S\+B\+Addr\+Ch, Object\+::info(), itohs(), spi\+Read(), spi\+Write(), and Object\+::warning().



Referenced by B\+O\+O\+S\+T\+\_\+\+P\+Y\+T\+H\+O\+N\+\_\+\+M\+O\+D\+U\+L\+E().


\begin{DoxyCode}
578 \{
579     \textcolor{keywordtype}{long} iTest, nBadTx=0, nBadRx=0, nFatal=0, nBad, regErrorHistogram[16];
580     \textcolor{keywordtype}{int} iFrame, iRetry, readOk, writeOk;
581     \textcolor{keywordtype}{double} fer;
582     \hyperlink{ICECALv3_8h_adf928e51a60dba0df29d615401cc55a8}{U16} writeData = 0x0000;
583     \hyperlink{ICECALv3_8h_adf928e51a60dba0df29d615401cc55a8}{U16} readData, retry;
584     PyObject* ferStatistics         = PyList\_New(0); 
585     PyObject* confRegAddresses  = PyList\_New(0);
586     PyObject* confRegHistogram  = PyList\_New(0);
587 
588     \hyperlink{ICECALv3_8h_a3cb25ca6f51f003950f9625ff05536fc}{U8}  addr;
589     \hyperlink{ICECALv3_8h_a3cb25ca6f51f003950f9625ff05536fc}{U8}  confRegList[16] = \{\hyperlink{ICECALv3_8h_a9c22ae782814495416dc2b803df326c1}{icecalMainAddr}[0] , \hyperlink{ICECALv3_8h_a9c22ae782814495416dc2b803df326c1}{icecalMainAddr}[1] , 
      icecalMainAddr[2] , icecalMainAddr[3] , \hyperlink{ICECALv3_8h_a848408b773702d268053cb49d205e097}{delayLineAddrCh}[0] , delayLineAddrCh[1] , delayLineAddrCh[2] , 
      delayLineAddrCh[3] ,
590                                                  \hyperlink{ICECALv3_8h_abd124f50fa794b9b0aded801fabf5322}{icecalLSBAddrCh}[0], icecalLSBAddrCh[1], 
      icecalLSBAddrCh[2], icecalLSBAddrCh[3], \hyperlink{ICECALv3_8h_afba64a649cc9314882fd49b62b99d6e7}{icecalMSBAddrCh}[0] , icecalMSBAddrCh[1] , 
      icecalMSBAddrCh[2] , icecalMSBAddrCh[3]\};
591 
592     \textcolor{comment}{//Error histogram. This will compute the number of error in each register address.}
593     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0 ; i<16 ; i++) regErrorHistogram[i] = 0;
594 
595     \hyperlink{classObject_a644fd329ea4cb85f54fa6846484b84a8}{info}(\textcolor{stringliteral}{"Starting SPI FER test..."},\textcolor{stringliteral}{"ICECALv3::spiFERTest"});
596 
597     \textcolor{comment}{//FER Test is performed N Times}
598     \textcolor{keywordflow}{for}(iTest=0 ; iTest<nTest ; iTest++)
599     \{
600         \textcolor{comment}{//For each test we check the 16 RW registers of the chip.}
601         \textcolor{keywordflow}{for}(iFrame=0 ; iFrame<16 ; iFrame++)
602         \{
603             addr = confRegList[iFrame];
604 
605             \textcolor{comment}{//Random data to be sent.}
606             writeData = rand() + rand();
607 
608             \textcolor{comment}{//Write + Read back.    }
609             \hyperlink{classICECALv3_aef00f02801dea4bda2093c930501dcdd}{spiWrite}(addr,writeData);
610             readData = \hyperlink{classICECALv3_aced41ce20a0853d6248b8df88412e57a}{spiRead}(addr);    
611 
612             \textcolor{comment}{//Data mismatch: let's see if it's a read, write or FATAL error;}
613             \textcolor{keywordflow}{if}(writeData != readData)
614             \{
615                 \textcolor{comment}{//The number of coincidences are counted. This loop will break when 5 R/W coincidences are
       found or after 50 retrials.}
616                 iRetry = 0;     readOk = 0;         writeOk = 0;
617                 \textcolor{keywordflow}{do}
618                 \{
619                     retry = \hyperlink{classICECALv3_aced41ce20a0853d6248b8df88412e57a}{spiRead}(addr);
620                     \textcolor{keywordflow}{if}(retry == readData )  readOk++;
621                     \textcolor{keywordflow}{if}(retry == writeData) writeOk++;
622                     iRetry++;
623                 \}
624                 \textcolor{keywordflow}{while}(readOk < 5 && writeOk < 5 && iRetry < 50);
625 
626                 \textcolor{comment}{//Number of total errors according to the source.}
627                 \textcolor{keywordflow}{if}          (iRetry >= 50) \{    \hyperlink{classObject_a204a95f57818c0f811933917a30eff45}{error}(\textcolor{stringliteral}{"Mismatch: the source of the SPI error could not
       be determined"},\textcolor{stringliteral}{"ICECALv3::spiFER"});     nFatal++;   \}
628                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (readOk >= 5)    \{  \hyperlink{classObject_a204a95f57818c0f811933917a30eff45}{error}(\textcolor{stringliteral}{"Mismatch: Write error @SPI = 0x"}+
      \hyperlink{classICECALv3_a04b02e583f191bfce34d05132cd23834}{itohs}(addr)+\textcolor{stringliteral}{". W = 0x"}+\hyperlink{classICECALv3_a04b02e583f191bfce34d05132cd23834}{itohs}(writeData)+\textcolor{stringliteral}{", R = 0x"}+\hyperlink{classICECALv3_a04b02e583f191bfce34d05132cd23834}{itohs}(readData)+\textcolor{stringliteral}{"."},\textcolor{stringliteral}{"ICECALv3::spiFER"});  
      nBadTx++;    \}
629                 \textcolor{keywordflow}{else}                                     \{  \hyperlink{classObject_a204a95f57818c0f811933917a30eff45}{error}(\textcolor{stringliteral}{"Mismatch: Read error @SPI = 0x"}+
      \hyperlink{classICECALv3_a04b02e583f191bfce34d05132cd23834}{itohs}(addr)+\textcolor{stringliteral}{".  W = 0x"}+\hyperlink{classICECALv3_a04b02e583f191bfce34d05132cd23834}{itohs}(writeData)+\textcolor{stringliteral}{", R = 0x"}+\hyperlink{classICECALv3_a04b02e583f191bfce34d05132cd23834}{itohs}(readData)+\textcolor{stringliteral}{"."},\textcolor{stringliteral}{"ICECALv3::spiFER"});     
      nBadRx++;    \}
630 
631                 \textcolor{comment}{//Number of total errors according to the number of SPI register.}
632                 regErrorHistogram[iFrame]++;
633             \}
634         \}
635     \}
636     nBad = nFatal + nBadTx + nBadRx;                            \textcolor{comment}{//Global number of errors.}
637     fer = (double)nBad / ((\textcolor{keywordtype}{double})nTest * 16.0);    \textcolor{comment}{//Frame Rate Error.}
638 
639     \textcolor{keywordflow}{for}(iFrame=0 ; iFrame<16 ; iFrame++) PyList\_Append(confRegAddresses, PyInt\_FromLong(confRegList[iFrame]
      ));              \textcolor{comment}{//A list with the SPI @s.}
640     \textcolor{keywordflow}{for}(iFrame=0 ; iFrame<16 ; iFrame++) PyList\_Append(confRegHistogram, PyInt\_FromLong(regErrorHistogram[
      iFrame]));    \textcolor{comment}{//The number of errors in this SPI @s.}
641 
642     \textcolor{comment}{//FER statistics list:}
643     PyList\_Append(ferStatistics, PyInt\_FromLong(nBad));         \textcolor{comment}{//# Bad frames (global).}
644     PyList\_Append(ferStatistics, PyFloat\_FromDouble(fer));  \textcolor{comment}{//Global FER (0 ~ 1).}
645     PyList\_Append(ferStatistics, PyInt\_FromLong(nFatal));       \textcolor{comment}{//# Fatal frames.}
646     PyList\_Append(ferStatistics, PyInt\_FromLong(nBadTx));       \textcolor{comment}{//# Bad TX frames.}
647     PyList\_Append(ferStatistics, PyInt\_FromLong(nBadRx));       \textcolor{comment}{//# Bad RX frames.}
648     PyList\_Append(ferStatistics, confRegAddresses);                 \textcolor{comment}{//SPI @ list.}
649     PyList\_Append(ferStatistics, confRegHistogram);                 \textcolor{comment}{//SPI error counters list.}
650 
651     \hyperlink{classObject_a65cd4fda577711660821fd2cd5a3b4c9}{warning}(\textcolor{stringliteral}{"SPI BER test finished!!!"});
652     \textcolor{keywordflow}{return} ferStatistics;
653 \}
\end{DoxyCode}
\mbox{\Hypertarget{classICECALv3_aced41ce20a0853d6248b8df88412e57a}\label{classICECALv3_aced41ce20a0853d6248b8df88412e57a}} 
\index{I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}!spi\+Read@{spi\+Read}}
\index{spi\+Read@{spi\+Read}!I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}}
\subsubsection{\texorpdfstring{spi\+Read()}{spiRead()}}
{\footnotesize\ttfamily \hyperlink{ICECALv3_8h_adf928e51a60dba0df29d615401cc55a8}{U16} I\+C\+E\+C\+A\+Lv3\+::spi\+Read (\begin{DoxyParamCaption}\item[{\hyperlink{ICECALv3_8h_a3cb25ca6f51f003950f9625ff05536fc}{U8}}]{conf\+Reg\+Addr,  }\item[{\hyperlink{ICECALv3_8h_a3cb25ca6f51f003950f9625ff05536fc}{U8}}]{offset\+Addr = {\ttfamily 128} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 537 of file I\+C\+E\+C\+A\+Lv3.\+cpp.



References conf\+Reg, I\+Odata\+::data\+U8(), Object\+::debug(), err, I\+Oobject\+::io(), Status\+Code\+::is\+Failure(), itohs(), I\+Oobject\+::read(), and Object\+::warning().



Referenced by bxid\+Resynch\+Status(), get\+Analog\+Ch(), get\+Delay\+Line\+Ch(), get\+Main\+Reg(), spi\+Address\+Scan(), spi\+F\+E\+R\+Test(), spi\+Write\+Safe(), and version().


\begin{DoxyCode}
538 \{
539     \hyperlink{ICECALv3_8h_adf928e51a60dba0df29d615401cc55a8}{U16} rxData;
540 
541     \hyperlink{ICECALv3_8h_a3cb25ca6f51f003950f9625ff05536fc}{U8}* buffer = \hyperlink{classICECALv3_a6e8b6c03f5b0f1d8281bf8a0fa46064f}{confReg}->\hyperlink{classIOobject_af04fb94137c3d86849f478ac5afab5d1}{io}()->\hyperlink{classIOdata_a75e9c318dbac3a39402179070943d4bc}{dataU8}();
542     buffer[2]  = confRegAddr + offsetAddr;                          \textcolor{comment}{//+128 = read   }
543 
544     \textcolor{keywordflow}{if} (\hyperlink{classICECALv3_a6e8b6c03f5b0f1d8281bf8a0fa46064f}{confReg}->\hyperlink{classIOobject_aa07610c11963b1db6710e3c76ceea456}{read}().\hyperlink{classStatusCode_a5dd22dc6eb2c52fc4cabc58f6dea2eb7}{isFailure}()) 
545     \{
546         \hyperlink{classObject_a65cd4fda577711660821fd2cd5a3b4c9}{warning}(\textcolor{stringliteral}{"ICECALv3 read (@"}+\hyperlink{classICECALv3_a04b02e583f191bfce34d05132cd23834}{itohs}(confRegAddr)+\textcolor{stringliteral}{") error."},\textcolor{stringliteral}{"ICECALv3::spiRead"});
547         \hyperlink{classICECALv3_ad8989925ee5b3ff322d863ce6aaff0bd}{err} = \textcolor{keyword}{true};
548         \textcolor{keywordflow}{return} 0;
549     \}
550     \textcolor{keywordflow}{else}
551     \{
552         \hyperlink{classICECALv3_ad8989925ee5b3ff322d863ce6aaff0bd}{err} = \textcolor{keyword}{false};
553         rxData = ((\hyperlink{ICECALv3_8h_adf928e51a60dba0df29d615401cc55a8}{U16})buffer[1] * 256) + (\hyperlink{ICECALv3_8h_adf928e51a60dba0df29d615401cc55a8}{U16})buffer[0];
554         \hyperlink{classObject_aac010553f022165573714b7014a15f0d}{debug}(\textcolor{stringliteral}{"Register (@"}+ \hyperlink{classICECALv3_a04b02e583f191bfce34d05132cd23834}{itohs}(confRegAddr) + \textcolor{stringliteral}{") = 0x"} + \hyperlink{classICECALv3_a04b02e583f191bfce34d05132cd23834}{itohs}(rxData),\textcolor{stringliteral}{"
      ICECALv3::spiRead"});
555         \textcolor{keywordflow}{return} rxData;
556     \}
557 
558 \}
\end{DoxyCode}
\mbox{\Hypertarget{classICECALv3_aef00f02801dea4bda2093c930501dcdd}\label{classICECALv3_aef00f02801dea4bda2093c930501dcdd}} 
\index{I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}!spi\+Write@{spi\+Write}}
\index{spi\+Write@{spi\+Write}!I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}}
\subsubsection{\texorpdfstring{spi\+Write()}{spiWrite()}}
{\footnotesize\ttfamily void I\+C\+E\+C\+A\+Lv3\+::spi\+Write (\begin{DoxyParamCaption}\item[{\hyperlink{ICECALv3_8h_a3cb25ca6f51f003950f9625ff05536fc}{U8}}]{conf\+Reg\+Addr,  }\item[{\hyperlink{ICECALv3_8h_adf928e51a60dba0df29d615401cc55a8}{U16}}]{conf\+Reg\+Data }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 561 of file I\+C\+E\+C\+A\+Lv3.\+cpp.



References conf\+Reg, I\+Odata\+::data\+U8(), Object\+::debug(), err, I\+Oobject\+::io(), Status\+Code\+::is\+Failure(), itohs(), Object\+::warning(), and I\+Oobject\+::write().



Referenced by spi\+F\+E\+R\+Test(), and spi\+Write\+Safe().


\begin{DoxyCode}
562 \{
563     \hyperlink{ICECALv3_8h_a3cb25ca6f51f003950f9625ff05536fc}{U8}* buffer = \hyperlink{classICECALv3_a6e8b6c03f5b0f1d8281bf8a0fa46064f}{confReg}->\hyperlink{classIOobject_af04fb94137c3d86849f478ac5afab5d1}{io}()->\hyperlink{classIOdata_a75e9c318dbac3a39402179070943d4bc}{dataU8}();
564     buffer[2] = confRegAddr;                                \textcolor{comment}{//Frame = buffer<2>, buffer<1>, buffer<0>}
565     buffer[1] = (\hyperlink{structconfRegData}{confRegData} >> 8) & 0xFF;
566     buffer[0] =  \hyperlink{structconfRegData}{confRegData}       & 0xFF;
567 
568     \hyperlink{classICECALv3_ad8989925ee5b3ff322d863ce6aaff0bd}{err} = \hyperlink{classICECALv3_a6e8b6c03f5b0f1d8281bf8a0fa46064f}{confReg}->\hyperlink{classIOobject_a9f6984bc9f0fadcf800f1be2523ac744}{write}().\hyperlink{classStatusCode_a5dd22dc6eb2c52fc4cabc58f6dea2eb7}{isFailure}();
569 
570     \textcolor{keywordflow}{if}(\hyperlink{classICECALv3_ad8989925ee5b3ff322d863ce6aaff0bd}{err})  \hyperlink{classObject_a65cd4fda577711660821fd2cd5a3b4c9}{warning}(\textcolor{stringliteral}{"ICECALv3 write error."},\textcolor{stringliteral}{"ICECALv3::spiWrite"});
571     \textcolor{keywordflow}{else}      \hyperlink{classObject_aac010553f022165573714b7014a15f0d}{debug}(\textcolor{stringliteral}{"ICECALv3 write (@"}+ \hyperlink{classICECALv3_a04b02e583f191bfce34d05132cd23834}{itohs}(confRegAddr) + \textcolor{stringliteral}{") = 0x"} + 
      \hyperlink{classICECALv3_a04b02e583f191bfce34d05132cd23834}{itohs}(\hyperlink{structconfRegData}{confRegData}),\textcolor{stringliteral}{"ICECALv3::spiWrite"});
572 \}
\end{DoxyCode}
\mbox{\Hypertarget{classICECALv3_aa0b8358ea0be8e47a8aded5e1551787f}\label{classICECALv3_aa0b8358ea0be8e47a8aded5e1551787f}} 
\index{I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}!spi\+Write\+Safe@{spi\+Write\+Safe}}
\index{spi\+Write\+Safe@{spi\+Write\+Safe}!I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}}
\subsubsection{\texorpdfstring{spi\+Write\+Safe()}{spiWriteSafe()}}
{\footnotesize\ttfamily bool I\+C\+E\+C\+A\+Lv3\+::spi\+Write\+Safe (\begin{DoxyParamCaption}\item[{\hyperlink{ICECALv3_8h_a3cb25ca6f51f003950f9625ff05536fc}{U8}}]{conf\+Reg\+Addr,  }\item[{\hyperlink{ICECALv3_8h_adf928e51a60dba0df29d615401cc55a8}{U16}}]{conf\+Reg\+Data }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 513 of file I\+C\+E\+C\+A\+Lv3.\+cpp.



References Object\+::error(), itohs(), n\+Retries, spi\+Read(), spi\+Write(), and Object\+::warning().



Referenced by set\+Analog\+Ch(), set\+Delay\+Line\+Ch(), and set\+Main\+Reg().


\begin{DoxyCode}
514 \{
515     \hyperlink{ICECALv3_8h_adf928e51a60dba0df29d615401cc55a8}{U16} rxRegData;
516     \textcolor{keywordtype}{bool} ok = \textcolor{keyword}{true};
517     \textcolor{keywordtype}{int} iteration = 0;
518 
519     \textcolor{keywordflow}{do}\{
520         \textcolor{comment}{//Data is sent and read back...}
521         \hyperlink{classICECALv3_aef00f02801dea4bda2093c930501dcdd}{spiWrite}(confRegAddr,\hyperlink{structconfRegData}{confRegData});   
522         rxRegData = \hyperlink{classICECALv3_aced41ce20a0853d6248b8df88412e57a}{spiRead}(confRegAddr);
523 
524         \textcolor{comment}{//Exit conditions are computed.}
525         ok = (rxRegData == \hyperlink{structconfRegData}{confRegData});
526         iteration++;
527     
528         \textcolor{keywordflow}{if}(!ok) \hyperlink{classObject_a65cd4fda577711660821fd2cd5a3b4c9}{warning}(\textcolor{stringliteral}{"Mismatch ("}+\hyperlink{classICECALv3_a04b02e583f191bfce34d05132cd23834}{itohs}(iteration)+\textcolor{stringliteral}{") in @SPI = 0x"}+
      \hyperlink{classICECALv3_a04b02e583f191bfce34d05132cd23834}{itohs}(confRegAddr)+\textcolor{stringliteral}{". Read: 0x"}+\hyperlink{classICECALv3_a04b02e583f191bfce34d05132cd23834}{itohs}(rxRegData)+\textcolor{stringliteral}{". Expected: 0x"}+
      \hyperlink{classICECALv3_a04b02e583f191bfce34d05132cd23834}{itohs}(confRegAddr)+\textcolor{stringliteral}{"."},\textcolor{stringliteral}{"ICECALv3::spiWriteSafe"}); 
529 
530     \}\textcolor{keywordflow}{while}(!ok && iteration<= \hyperlink{classICECALv3_ae877ce34b3a4d6c368cc6409ac9614fa}{nRetries});
531 
532     \textcolor{keywordflow}{if}(!ok) \hyperlink{classObject_a204a95f57818c0f811933917a30eff45}{error}(\textcolor{stringliteral}{"Too many errors ("}+\hyperlink{classICECALv3_a04b02e583f191bfce34d05132cd23834}{itohs}(iteration)+\textcolor{stringliteral}{"). Check electronics!"},\textcolor{stringliteral}{"
      ICECALv3::spiWriteSafe"});
533     \textcolor{keywordflow}{return} !ok;
534 \}
\end{DoxyCode}
\mbox{\Hypertarget{classICECALv3_ab2a00809e9a4f2ab83ef041a886ca637}\label{classICECALv3_ab2a00809e9a4f2ab83ef041a886ca637}} 
\index{I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}!update@{update}}
\index{update@{update}!I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}}
\subsubsection{\texorpdfstring{update()}{update()}}
{\footnotesize\ttfamily void I\+C\+E\+C\+A\+Lv3\+::update (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}

Update the \hyperlink{classElement}{Element} configuration from the actual hardware 

Implements \hyperlink{classElement_a4e6c83efae95616ebddd03c793a26661}{Element}.



Definition at line 127 of file I\+C\+E\+C\+A\+Lv3.\+h.



Referenced by A3\+P\+E\+\_\+\+Bit\+Flip.\+A3\+P\+E\+\_\+\+Bit\+Flip\+::\+\_\+\+\_\+init\+\_\+\+\_\+(), Acquisition.\+Acquisition\+::\+\_\+\+\_\+init\+\_\+\+\_\+(), Emulate\+F\+E.\+Emulate\+F\+E\+::\+\_\+\+\_\+init\+\_\+\+\_\+(), App\+Frame.\+App\+Frame\+::delete\+Hardware(), Conf\+Frame.\+Conf\+Frame\+::on\+Change(), Graph\+Frame.\+Graph\+Frame\+::on\+Change(), Cfg\+Frame.\+Cfg\+Frame\+::on\+Change(), Conf\+Frame.\+Conf\+Frame\+::on\+Edit(), App\+Frame.\+App\+Frame\+::on\+Load(), Conf\+Frame.\+Conf\+Frame\+::on\+Re\+Load(), Graph\+Frame.\+Graph\+Frame\+::on\+Re\+Load(), Cfg\+Frame.\+Cfg\+Frame\+::on\+Re\+Load(), and App\+Frame.\+App\+Frame\+::on\+Re\+Load().


\begin{DoxyCode}
127                  \{
128     
129   \};
\end{DoxyCode}
\mbox{\Hypertarget{classICECALv3_a7f3f8012d2e5c45f8e43819befa3f915}\label{classICECALv3_a7f3f8012d2e5c45f8e43819befa3f915}} 
\index{I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}!version@{version}}
\index{version@{version}!I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}}
\subsubsection{\texorpdfstring{version()}{version()}}
{\footnotesize\ttfamily double I\+C\+E\+C\+A\+Lv3\+::version (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 660 of file I\+C\+E\+C\+A\+Lv3.\+cpp.



References ftos(), I\+C\+E\+C\+A\+L\+\_\+\+V\+E\+R\+S\+I\+O\+N\+\_\+\+A\+D\+DR, Object\+::info(), itos(), and spi\+Read().



Referenced by B\+O\+O\+S\+T\+\_\+\+P\+Y\+T\+H\+O\+N\+\_\+\+M\+O\+D\+U\+L\+E().


\begin{DoxyCode}
661 \{
662     \hyperlink{ICECALv3_8h_adf928e51a60dba0df29d615401cc55a8}{U16} rxversion;
663     \textcolor{keywordtype}{double} major,minor,\hyperlink{classICECALv3_a7f3f8012d2e5c45f8e43819befa3f915}{version};
664     \textcolor{keywordtype}{string} version\_str;
665 
666     rxversion = \hyperlink{classICECALv3_aced41ce20a0853d6248b8df88412e57a}{spiRead}(\hyperlink{ICECALv3_8h_a46a6446285e0e7808feebc4bc9ef52e1}{ICECAL\_VERSION\_ADDR}, 0x00 );
667 
668     major = (double)((rxversion>>12) & 0x0F); 
669     minor = (double)((rxversion >>8) & 0x0F);
670     version\_str = \hyperlink{Tools_8h_af330027dbdafb9a30768b3613c553e60}{itos}(major) + \textcolor{stringliteral}{"."} + \hyperlink{Tools_8h_af330027dbdafb9a30768b3613c553e60}{itos}(minor);
671     version = atof( version\_str.c\_str() );
672 
673     \hyperlink{classObject_a644fd329ea4cb85f54fa6846484b84a8}{info}(\textcolor{stringliteral}{"ICECAL Version: "} + \hyperlink{Tools_8h_ae78000c70889d75d67813c6cb83010a6}{ftos}(version),\textcolor{stringliteral}{"ICECALv3::version"});
674     \textcolor{keywordflow}{return} \hyperlink{classICECALv3_a7f3f8012d2e5c45f8e43819befa3f915}{version};
675 \}
\end{DoxyCode}
\mbox{\Hypertarget{classICECALv3_a9d7c33e6d113e7f721dc848d28ab44d8}\label{classICECALv3_a9d7c33e6d113e7f721dc848d28ab44d8}} 
\index{I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}!write\+Asic\+Params@{write\+Asic\+Params}}
\index{write\+Asic\+Params@{write\+Asic\+Params}!I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}}
\subsubsection{\texorpdfstring{write\+Asic\+Params()}{writeAsicParams()}}
{\footnotesize\ttfamily bool I\+C\+E\+C\+A\+Lv3\+::write\+Asic\+Params (\begin{DoxyParamCaption}\item[{string}]{file\+Name,  }\item[{Py\+Object $\ast$}]{params }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 156 of file I\+C\+E\+C\+A\+Lv3.\+cpp.



References C\+A\+L\+I\+B\+R\+A\+T\+I\+O\+N\+\_\+\+F\+I\+L\+E\+\_\+\+V\+ER.



Referenced by dump\+Config().


\begin{DoxyCode}
157 \{
158   time\_t rawtime;
159   \textcolor{keyword}{struct }tm * timeinfo;
160     \textcolor{keywordtype}{char} dStr[64], tStr[64];
161     ofstream fd;
162     PyObject* l;        \textcolor{comment}{//Temporary list to accomodate 'asicParams' main list list objects.}
163 
164     \textcolor{comment}{//'asicParams' output example:}
165     \textcolor{comment}{//['R1403C0000', [19, 24, 0, 0, 1], [2, 3, 6, 0, 0, 0, 19, 48, 0], [19, 24, 0, 0, 1],}
166     \textcolor{comment}{// [2, 3, 6, 0, 0, 0, 19, 48, 0], [19, 24, 0, 0, 1], [2, 3, 6, 0, 0, 0, 19, 48, 0], }
167     \textcolor{comment}{// [19, 24, 0, 0, 1], [2, 3, 6, 0, 0, 0, 19, 48, 0], [0, 0, 0, 56, 0, 56, 0, 9, 56, 0, 56, 0]]}
168 
169   time (&rawtime);
170   timeinfo = localtime (&rawtime);
171     strftime (dStr,64,\textcolor{stringliteral}{"%Y/%m/%d"},timeinfo);
172     strftime (tStr,64,\textcolor{stringliteral}{"%R"},timeinfo);   
173 
174     fd.open (fileName.c\_str(), ios\_base::out);
175     \textcolor{keywordflow}{if}(fd.is\_open())
176     \{
177         fd << \textcolor{stringliteral}{"#########################################################"} << endl;
178         fd << \textcolor{stringliteral}{"#############   ICECAL CALIBRATION FILE   ###############"} << endl;
179         fd << \textcolor{stringliteral}{"#########################################################"} << endl;
180         fd << \textcolor{stringliteral}{""} << endl;
181         fd << \textcolor{stringliteral}{"#File Version     : v"} << \hyperlink{ICECALv3_8h_ab10444bd2aa43310cf654abe4e4a7af6}{CALIBRATION\_FILE\_VER} << endl;
182         fd << \textcolor{stringliteral}{"#Date (YYYY/MM/DD): "} << string(dStr) << endl;
183         fd << \textcolor{stringliteral}{"#Time (HH:MM)     : "} << string(tStr) << endl;
184         fd << \textcolor{stringliteral}{"#ICECAL Chip ID   : "} << PyString\_AsString(PyList\_GetItem(asicParams,0)) << endl;
185         fd << \textcolor{stringliteral}{""} << endl << endl;
186     
187         fd << \textcolor{stringliteral}{"#########################################################"} << endl;
188         fd << \textcolor{stringliteral}{"# ICECAL Main Register Parameters:"} << endl;
189         fd << \textcolor{stringliteral}{"#########################################################"} << endl;
190         fd << \textcolor{stringliteral}{""} << endl;
191 
192         l = PyList\_GetItem(asicParams,9);       \textcolor{comment}{//list item 9. ICECAL Main config reg.}
193         fd <<   \textcolor{stringliteral}{"VCONTROL\_OE = "} << PyInt\_AsLong(PyList\_GetItem(l,0)) << endl;
194         fd <<   \textcolor{stringliteral}{"BXID\_SYN\_OE = "} << PyInt\_AsLong(PyList\_GetItem(l,1)) << endl;
195         fd <<   \textcolor{stringliteral}{"CLK\_REFRESH = "} << PyInt\_AsLong(PyList\_GetItem(l,2)) << endl;
196         fd <<   \textcolor{stringliteral}{"IBIAS\_OB    = "} << PyInt\_AsLong(PyList\_GetItem(l,3)) << endl;
197         fd <<   \textcolor{stringliteral}{"IBIAS\_CE\_TH = "} << PyInt\_AsLong(PyList\_GetItem(l,4)) << endl;
198         fd <<   \textcolor{stringliteral}{"IBIAS\_TH    = "} << PyInt\_AsLong(PyList\_GetItem(l,5)) << endl;
199         fd <<   \textcolor{stringliteral}{"IBIAS\_INT   = "} << PyInt\_AsLong(PyList\_GetItem(l,6)) << endl;
200         fd <<   \textcolor{stringliteral}{"IBIAS\_CE\_IN = "} << PyInt\_AsLong(PyList\_GetItem(l,7)) << endl;
201         fd <<   \textcolor{stringliteral}{"IBIAS\_CE\_PZ = "} << PyInt\_AsLong(PyList\_GetItem(l,8)) << endl;  
202         fd <<   \textcolor{stringliteral}{"IBIAS\_0T    = "} << PyInt\_AsLong(PyList\_GetItem(l,9)) << endl;
203         fd <<   \textcolor{stringliteral}{"IBIAS\_PZ    = "} << PyInt\_AsLong(PyList\_GetItem(l,10)) << endl;
204         fd <<   \textcolor{stringliteral}{"IBIAS\_V0T   = "} << PyInt\_AsLong(PyList\_GetItem(l,11)) << endl;
205         fd << \textcolor{stringliteral}{""} << endl << endl;
206 
207         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<4;i++)
208         \{
209             fd << \textcolor{stringliteral}{"#########################################################"} << endl;
210             fd << \textcolor{stringliteral}{"#Channel #"} << i << \textcolor{stringliteral}{" Parameters:"} << endl;
211             fd << \textcolor{stringliteral}{"#########################################################"} << endl;
212             fd << \textcolor{stringliteral}{""} << endl;
213 
214             l = PyList\_GetItem(asicParams,1+2*i);       \textcolor{comment}{//list items 1, 3, 5, 7. Delay line config regs.}
215             fd <<   \textcolor{stringliteral}{"PHASE\_ADC["} << i << \textcolor{stringliteral}{"]   = "} << PyInt\_AsLong(PyList\_GetItem(l,0)) << endl;
216             fd <<   \textcolor{stringliteral}{"PHASE\_TH["} << i << \textcolor{stringliteral}{"]    = "} << PyInt\_AsLong(PyList\_GetItem(l,1)) << endl;
217             fd <<   \textcolor{stringliteral}{"PHASE\_INT["} << i << \textcolor{stringliteral}{"]   = "} << PyInt\_AsLong(PyList\_GetItem(l,2)) << endl;
218             fd <<   \textcolor{stringliteral}{"LOC\_SEL["} << i << \textcolor{stringliteral}{"]     = "} << PyInt\_AsLong(PyList\_GetItem(l,3)) << endl;
219             fd <<   \textcolor{stringliteral}{"LVDS\_OEN["} << i << \textcolor{stringliteral}{"]    = "} << PyInt\_AsLong(PyList\_GetItem(l,4)) << endl;
220 
221             l = PyList\_GetItem(asicParams,2+2*i);       \textcolor{comment}{//list items 2, 4, 6, 8. ICECAL Analog config regs.}
222             fd <<   \textcolor{stringliteral}{"CINT\_SUBCH0["} << i << \textcolor{stringliteral}{"] = "} << PyInt\_AsLong(PyList\_GetItem(l,0)) << endl;
223             fd <<   \textcolor{stringliteral}{"CINT\_SUBCH1["} << i << \textcolor{stringliteral}{"] = "} << PyInt\_AsLong(PyList\_GetItem(l,1)) << endl;
224             fd <<   \textcolor{stringliteral}{"IOFF\_SUBCH0["} << i << \textcolor{stringliteral}{"] = "} << PyInt\_AsLong(PyList\_GetItem(l,2)) << endl;
225             fd <<   \textcolor{stringliteral}{"IOFF\_SUBCH1["} << i << \textcolor{stringliteral}{"] = "} << PyInt\_AsLong(PyList\_GetItem(l,3)) << endl;
226             fd <<   \textcolor{stringliteral}{"ZERO["} << i << \textcolor{stringliteral}{"]        = "} << PyInt\_AsLong(PyList\_GetItem(l,4)) << endl;
227             fd <<   \textcolor{stringliteral}{"POLE["} << i << \textcolor{stringliteral}{"]        = "} << PyInt\_AsLong(PyList\_GetItem(l,5)) << endl;
228             fd <<   \textcolor{stringliteral}{"ZIN["} << i << \textcolor{stringliteral}{"]         = "} << PyInt\_AsLong(PyList\_GetItem(l,6)) << endl; 
229             fd << \textcolor{stringliteral}{""} << endl;
230         \}
231 
232         fd.close();
233         \textcolor{keywordflow}{return} \textcolor{keyword}{true};
234     \}
235     \textcolor{keywordflow}{else} \textcolor{keywordflow}{return} \textcolor{keyword}{false};
236 \}
\end{DoxyCode}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classICECALv3_a6e8b6c03f5b0f1d8281bf8a0fa46064f}\label{classICECALv3_a6e8b6c03f5b0f1d8281bf8a0fa46064f}} 
\index{I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}!conf\+Reg@{conf\+Reg}}
\index{conf\+Reg@{conf\+Reg}!I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}}
\subsubsection{\texorpdfstring{conf\+Reg}{confReg}}
{\footnotesize\ttfamily \hyperlink{classRegister}{Register}$\ast$ I\+C\+E\+C\+A\+Lv3\+::conf\+Reg\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 129 of file I\+C\+E\+C\+A\+Lv3.\+h.



Referenced by I\+C\+E\+C\+A\+Lv3(), spi\+Read(), and spi\+Write().

\mbox{\Hypertarget{classICECALv3_ad8989925ee5b3ff322d863ce6aaff0bd}\label{classICECALv3_ad8989925ee5b3ff322d863ce6aaff0bd}} 
\index{I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}!err@{err}}
\index{err@{err}!I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}}
\subsubsection{\texorpdfstring{err}{err}}
{\footnotesize\ttfamily bool I\+C\+E\+C\+A\+Lv3\+::err\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 139 of file I\+C\+E\+C\+A\+Lv3.\+h.



Referenced by get\+Analog\+Ch(), get\+Delay\+Line\+Ch(), get\+Main\+Reg(), set\+Analog\+Ch(), set\+Delay\+Line\+Ch(), set\+Main\+Reg(), spi\+Read(), and spi\+Write().

\mbox{\Hypertarget{classICECALv3_ae877ce34b3a4d6c368cc6409ac9614fa}\label{classICECALv3_ae877ce34b3a4d6c368cc6409ac9614fa}} 
\index{I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}!n\+Retries@{n\+Retries}}
\index{n\+Retries@{n\+Retries}!I\+C\+E\+C\+A\+Lv3@{I\+C\+E\+C\+A\+Lv3}}
\subsubsection{\texorpdfstring{n\+Retries}{nRetries}}
{\footnotesize\ttfamily int I\+C\+E\+C\+A\+Lv3\+::n\+Retries\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 137 of file I\+C\+E\+C\+A\+Lv3.\+h.



Referenced by spi\+Write\+Safe().



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/home/eleclhcb/\+L\+H\+Cb/lbcat-\/cmake/\+Cat\+Bcn/inc/\hyperlink{ICECALv3_8h}{I\+C\+E\+C\+A\+Lv3.\+h}\item 
/home/eleclhcb/\+L\+H\+Cb/lbcat-\/cmake/\+Cat\+Bcn/src/\hyperlink{ICECALv3_8cpp}{I\+C\+E\+C\+A\+Lv3.\+cpp}\end{DoxyCompactItemize}
