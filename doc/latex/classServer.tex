\hypertarget{classServer}{
\section{Server Class Reference}
\label{classServer}\index{Server@{Server}}
}


{\ttfamily \#include $<$inc/Server.h$>$}\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classServer_ac808c867e64a7f139b1958abeb387a15}{Server} (\hyperlink{classApplication}{Application} $\ast$)
\begin{DoxyCompactList}\small\item\em Standard constructor. \item\end{DoxyCompactList}\item 
virtual \hyperlink{classServer_a4b3aa2579cb1c8cd1d069582c14d0fa6}{$\sim$Server} ()
\begin{DoxyCompactList}\small\item\em Destructor. \item\end{DoxyCompactList}\item 
\hyperlink{classStatusCode}{StatusCode} \hyperlink{classServer_a039cc5b24c26fa5bb8145335f27bb28e}{start} ()
\begin{DoxyCompactList}\small\item\em Start Service. \item\end{DoxyCompactList}\item 
\hyperlink{classStatusCode}{StatusCode} \hyperlink{classServer_abaa0b878f4f96454339f1989ec12cc6b}{updateState} ()
\begin{DoxyCompactList}\small\item\em Update \hyperlink{classState}{State} Service. \item\end{DoxyCompactList}\item 
\hyperlink{classStatusCode}{StatusCode} \hyperlink{classServer_af58d60a5587813e2aab7fc9016dfa01a}{updateConfig} ()
\begin{DoxyCompactList}\small\item\em Update \hyperlink{classConfig}{Config} Service. \item\end{DoxyCompactList}\item 
\hyperlink{classStatusCode}{StatusCode} \hyperlink{classServer_adc7d38a333b12fbe03db3d209f5feae9}{cmdline} (std::vector$<$ std::string $>$)
\item 
void \hyperlink{classServer_ac885fb635733c69a28fe3ec9bd21eac5}{setUpdateDelay} (int updateDelay)
\item 
int \hyperlink{classServer_ac3b91a1bf06dab7911e6d1b867d677bc}{updateDelay} ()
\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classApplication}{Application} $\ast$ \hyperlink{classServer_ae1c25dc357c4a1145289c747fddaa251}{m\_\-app}
\item 
int \hyperlink{classServer_ae991d55181bff0552a34278ea9f76735}{m\_\-updateDelay}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyAuthor}{Author}
Frederic Machefert 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2005-\/03-\/03 
\end{DoxyDate}


Definition at line 22 of file Server.h.

\subsection{Constructor \& Destructor Documentation}
\hypertarget{classServer_ac808c867e64a7f139b1958abeb387a15}{
\index{Server@{Server}!Server@{Server}}
\index{Server@{Server}!Server@{Server}}
\subsubsection[{Server}]{\setlength{\rightskip}{0pt plus 5cm}Server::Server ({\bf Application} $\ast$ {\em application})}}
\label{classServer_ac808c867e64a7f139b1958abeb387a15}


Standard constructor. 

Definition at line 26 of file Server.cpp.

References Object::info(), m\_\-app, m\_\-updateDelay, and Object::warning().


\begin{DoxyCode}
26                                          {
27   m_app = application;
28 #ifdef _NETWORK_
29   m_updateDelay = 1;
30   m_app->info("Server built.","Server::Server");
31   m_servCmd    = new CmndServ ( m_app );
32   m_servCtrl   = new CtrlServ ( m_app );
33   m_servTimer  = 0;
34   m_servState  = 0;
35   m_servConfig = 0;
36 #else
37   m_app->warning("Compilation without NETWORK capabilities","Server::Server"); 
38 #endif  
39 }
\end{DoxyCode}
\hypertarget{classServer_a4b3aa2579cb1c8cd1d069582c14d0fa6}{
\index{Server@{Server}!$\sim$Server@{$\sim$Server}}
\index{$\sim$Server@{$\sim$Server}!Server@{Server}}
\subsubsection[{$\sim$Server}]{\setlength{\rightskip}{0pt plus 5cm}Server::$\sim$Server ()\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classServer_a4b3aa2579cb1c8cd1d069582c14d0fa6}


Destructor. 

Definition at line 44 of file Server.cpp.


\begin{DoxyCode}
44                 {
45 #ifdef _NETWORK_
46   delete m_servCmd;
47   delete m_servCtrl;
48   if ( 0 != m_servState ) {
49     delete m_servState;
50   }
51   if ( 0 != m_servTimer ) {
52     delete m_servTimer;
53   }
54   if ( 0 != m_servConfig ) {
55     delete m_servConfig;
56   }
57   m_servCmd    = 0;
58   m_servCtrl   = 0;
59   m_servTimer  = 0;
60   m_servState  = 0;
61   m_servConfig = 0;
62 #endif
63 }
\end{DoxyCode}


\subsection{Member Function Documentation}
\hypertarget{classServer_adc7d38a333b12fbe03db3d209f5feae9}{
\index{Server@{Server}!cmdline@{cmdline}}
\index{cmdline@{cmdline}!Server@{Server}}
\subsubsection[{cmdline}]{\setlength{\rightskip}{0pt plus 5cm}{\bf StatusCode} Server::cmdline (std::vector$<$ std::string $>$ {\em cmd})}}
\label{classServer_adc7d38a333b12fbe03db3d209f5feae9}


Definition at line 128 of file Server.cpp.

References StatusCode::FAILURE, Object::info(), m\_\-app, setUpdateDelay(), StatusCode::SUCCESS, updateConfig(), updateDelay(), and updateState().


\begin{DoxyCode}
128                                                         {  
129   if ( cmd.size()==0){
130     char line[200];
131     std::string tmp;
132     sprintf(line,"Timer    [timer]    : %i", updateDelay() );
133     m_app->info(line,"Server::cmdline");
134     return StatusCode::SUCCESS;
135   }
136   
137   transform(cmd[0].begin(),cmd[0].end(),cmd[0].begin(),tolower);
138 
139   if (cmd[0].compare("timer")==0){
140     if ( cmd.size() == 2 ) {
141       setUpdateDelay ( atoi(cmd[1].c_str()) );
142       this -> updateConfig();
143       this -> updateState();  
144     }
145     this -> updateConfig();
146     this -> updateState();
147     return StatusCode::SUCCESS;
148   }
149   return StatusCode::FAILURE;
150 }
\end{DoxyCode}
\hypertarget{classServer_ac885fb635733c69a28fe3ec9bd21eac5}{
\index{Server@{Server}!setUpdateDelay@{setUpdateDelay}}
\index{setUpdateDelay@{setUpdateDelay}!Server@{Server}}
\subsubsection[{setUpdateDelay}]{\setlength{\rightskip}{0pt plus 5cm}void Server::setUpdateDelay (int {\em updateDelay})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{classServer_ac885fb635733c69a28fe3ec9bd21eac5}
Set accessor to member m\_\-updateDelay 
\begin{DoxyParams}{Parameters}
\item[{\em updateDelay}]the new value for m\_\-updateDelay \end{DoxyParams}


Definition at line 41 of file Server.h.

References m\_\-updateDelay.

Referenced by cmdline().


\begin{DoxyCode}
41                                         {
42     m_updateDelay = updateDelay;
43 #ifdef _NETWORK_
44     if ( 0 != m_servTimer ){
45       m_servTimer->setDelay ( m_updateDelay );
46     }
47 #endif
48   }
\end{DoxyCode}
\hypertarget{classServer_a039cc5b24c26fa5bb8145335f27bb28e}{
\index{Server@{Server}!start@{start}}
\index{start@{start}!Server@{Server}}
\subsubsection[{start}]{\setlength{\rightskip}{0pt plus 5cm}{\bf StatusCode} Server::start ()}}
\label{classServer_a039cc5b24c26fa5bb8145335f27bb28e}


Start Service. 

Definition at line 98 of file Server.cpp.

References application(), Application::config(), StatusCode::FAILURE, Object::info(), m\_\-app, Object::name(), Application::procDb(), Application::state(), StatusCode::SUCCESS, updateDelay(), and Object::warning().

Referenced by Application::network(), and Application::server().


\begin{DoxyCode}
98                            {
99 #ifdef _NETWORK_
100   m_app->info("Starting CAT server " + application()->name(),"Server::start");
101   DimServer::start(m_app->name().c_str());
102   std::string str =  m_app->name() ;
103   str = m_app->name() ;
104   str.append ("/state");
105   m_servState = new DimService ( str.c_str(),"I:4;C",
106                                  m_app->state(),
107                                  sizeof(*(m_app->state())) );
108   m_servTimer = new Timer    ( updateDelay() , m_servState );
109   str = application()->name() ;
110   str.append ("/config"); 
111   m_servConfig = new DimService ( str.c_str(),"C",
112                                   m_app->config(),
113                                   sizeof(*(m_app->config())) );
114 
115   m_app->procDb()->startServices();
116 #else
117   m_app->warning("compilation without NETWORK capabilities. Cannot start server."
      ,
118                  "Server::star");
119   return StatusCode::FAILURE;
120 #endif
121   return StatusCode::SUCCESS;
122 }
\end{DoxyCode}
\hypertarget{classServer_af58d60a5587813e2aab7fc9016dfa01a}{
\index{Server@{Server}!updateConfig@{updateConfig}}
\index{updateConfig@{updateConfig}!Server@{Server}}
\subsubsection[{updateConfig}]{\setlength{\rightskip}{0pt plus 5cm}{\bf StatusCode} Server::updateConfig ()}}
\label{classServer_af58d60a5587813e2aab7fc9016dfa01a}


Update \hyperlink{classConfig}{Config} Service. 

Definition at line 83 of file Server.cpp.

References Object::debug(), StatusCode::FAILURE, m\_\-app, StatusCode::SUCCESS, and Object::warning().

Referenced by cmdline(), and Application::setConfig().


\begin{DoxyCode}
83                                   {
84 #ifdef _NETWORK_
85   m_servConfig->updateService();
86   m_app->debug("Updating proc database service.","Server::updateConfig");
87 #else
88   m_app->warning("Updating server services not available (NETWORK mode off).",
89                  "Server::updateConfig"); 
90   return StatusCode::FAILURE;
91 #endif
92   return StatusCode::SUCCESS;
93 }
\end{DoxyCode}
\hypertarget{classServer_ac3b91a1bf06dab7911e6d1b867d677bc}{
\index{Server@{Server}!updateDelay@{updateDelay}}
\index{updateDelay@{updateDelay}!Server@{Server}}
\subsubsection[{updateDelay}]{\setlength{\rightskip}{0pt plus 5cm}int Server::updateDelay ()\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{classServer_ac3b91a1bf06dab7911e6d1b867d677bc}
Get accessor to member m\_\-updateDelay \begin{DoxyReturn}{Returns}
the current value of m\_\-updateDelay 
\end{DoxyReturn}


Definition at line 54 of file Server.h.

References m\_\-updateDelay.

Referenced by cmdline(), and start().


\begin{DoxyCode}
54                      {
55     return m_updateDelay;
56   }
\end{DoxyCode}
\hypertarget{classServer_abaa0b878f4f96454339f1989ec12cc6b}{
\index{Server@{Server}!updateState@{updateState}}
\index{updateState@{updateState}!Server@{Server}}
\subsubsection[{updateState}]{\setlength{\rightskip}{0pt plus 5cm}{\bf StatusCode} Server::updateState ()}}
\label{classServer_abaa0b878f4f96454339f1989ec12cc6b}


Update \hyperlink{classState}{State} Service. 

Definition at line 68 of file Server.cpp.

References Object::debug(), StatusCode::FAILURE, m\_\-app, StatusCode::SUCCESS, and Object::warning().

Referenced by cmdline(), and Application::setState().


\begin{DoxyCode}
68                                  {
69 #ifdef _NETWORK_
70   m_servState->updateService();
71   m_app->debug("Updating state service.","Server::updateState"); 
72 #else
73   m_app->warning("Updating server services not available (NETWORK mode off).",
74                  "Server::updateState"); 
75   return StatusCode::FAILURE;
76 #endif
77   return StatusCode::SUCCESS;
78 }
\end{DoxyCode}


\subsection{Member Data Documentation}
\hypertarget{classServer_ae1c25dc357c4a1145289c747fddaa251}{
\index{Server@{Server}!m\_\-app@{m\_\-app}}
\index{m\_\-app@{m\_\-app}!Server@{Server}}
\subsubsection[{m\_\-app}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Application}$\ast$ {\bf Server::m\_\-app}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classServer_ae1c25dc357c4a1145289c747fddaa251}


Definition at line 79 of file Server.h.

Referenced by cmdline(), Server(), start(), updateConfig(), and updateState().\hypertarget{classServer_ae991d55181bff0552a34278ea9f76735}{
\index{Server@{Server}!m\_\-updateDelay@{m\_\-updateDelay}}
\index{m\_\-updateDelay@{m\_\-updateDelay}!Server@{Server}}
\subsubsection[{m\_\-updateDelay}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf Server::m\_\-updateDelay}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classServer_ae991d55181bff0552a34278ea9f76735}


Definition at line 80 of file Server.h.

Referenced by Server(), setUpdateDelay(), and updateDelay().

The documentation for this class was generated from the following files:\begin{DoxyCompactItemize}
\item 
/home/eleclhcb/LHCb/lbcat-\/cmake/CatKernel/inc/\hyperlink{Server_8h}{Server.h}\item 
/home/eleclhcb/LHCb/lbcat-\/cmake/CatKernel/src/\hyperlink{Server_8cpp}{Server.cpp}\end{DoxyCompactItemize}
