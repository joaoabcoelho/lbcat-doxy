<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Cat: CAT Tutorial</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Cat
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">CAT Tutorial </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="el" href="tutorial.html">CAT Tutorial</a></p>
<h2>seful commands: </h2>
<blockquote class="doxtable">
<p>CTRL+ALT+fleche </p>
</blockquote>
<p>fenetre PC</p>
<blockquote class="doxtable">
<p>cd </p>
</blockquote>
<p>remonte ds arborescence</p>
<blockquote class="doxtable">
<p>setupCat </p>
</blockquote>
<p>et se deplacer ou sont les fichiers de configuration</p>
<blockquote class="doxtable">
<p>cd LHCb/lbcat-febv1 </p>
</blockquote>
<p>on trouve ds ce repertoire Feb_v1.py et ds le ss repertoire FEV_v1 FEB.py</p>
<blockquote class="doxtable">
<p>catcmd </p>
</blockquote>
<p>démarre le soft</p>
<blockquote class="doxtable">
<p>execfile("FEB_v1.py") </p>
</blockquote>
<p>vient apres la commande catcmd attention pas de blanc de tb etc ...</p>
<blockquote class="doxtable">
<p>CTRL+d </p>
</blockquote>
<p>pour revenir au terminal help(Configuration) // Affiche l'aide du module Configuration (taper 'q' pour sortir de l'aide) help(fe) // Affiche l'aide sur l'objet fe (qui est ici une carte <a class="el" href="classFEB__v1.html">FEB_v1</a>) (taper 'q' pour sortir de l'aide)</p>
<h2>Slow Control (USB/I2C/SPI): </h2>
<h3>USB</h3>
<blockquote class="doxtable">
<p><a class="el" href="namespaceshell.html#a2f31bbe4baf894f4863c4d392239ab8b">fe.reset()</a> </p>
</blockquote>
<p>Full reset of the board</p>
<blockquote class="doxtable">
<p>fe.resetUsb() </p>
</blockquote>
<p>Reset of the Rx and Tx fifo of the usb interface</p>
<h3>SPI</h3>
<p>Orientation du bus SPI sur le device à l'adresse 17 (Trig/Seq PGA)</p>
<blockquote class="doxtable">
<p>seq.setSpiAdd(17) </p>
</blockquote>
<p>Ecriture/lecture d'un mot (valeur 10) à la sous-adresse 3</p>
<blockquote class="doxtable">
<p>seq.spiWrite(3,10) </p>
</blockquote>
<blockquote class="doxtable">
<p>seq.spiRead(3) </p>
</blockquote>
<p>retourne la valeur 10</p>
<p>Ecriture/lecture d'un bloc de 4 mots à la sous-adresse 3</p>
<blockquote class="doxtable">
<p>seq.spiWrite(3,4,[1,2,3,4]) </p>
</blockquote>
<blockquote class="doxtable">
<p>a=seq.spiRead(3,4) </p>
</blockquote>
<p>retourne la liste [1,2,3,4] stockée dans la variable a.</p>
<p>Exemple avec le ICECAL</p>
<blockquote class="doxtable">
<p>seq.setSpiAdd(11) </p>
</blockquote>
<p>écriture dans icecal 4 par spi</p>
<blockquote class="doxtable">
<p>seq.spiWrite(28,xx) </p>
</blockquote>
<p>écriture valeur xx registre horloge channel 0 du icecal</p>
<p>Exemples avec une valeur en hexa</p>
<blockquote class="doxtable">
<p>seq.setSpiAdd(9) </p>
</blockquote>
<p>set Spi add for read/write to the FEPGA 4 (address 9)</p>
<blockquote class="doxtable">
<p>seq.spiWrite(4,int('0x20F',16)+256) </p>
</blockquote>
<p>Ecrire register 4 de la valeur hex 20f + decimal 256</p>
<blockquote class="doxtable">
<p>seq.spiRead(3) </p>
</blockquote>
<p>Lecture du registre 3 en decimal</p>
<blockquote class="doxtable">
<p>hex(seq.spiRead(3)) </p>
</blockquote>
<p>Lecture du registre 3 avec conversion en hexa</p>
<h2>FIFO: </h2>
<blockquote class="doxtable">
<p>fe.resetFifoInjectFE(5) </p>
</blockquote>
<p>reset pointeur fifo injection Fepga 5</p>
<blockquote class="doxtable">
<p>fe.resetFifoSpyFE(5) </p>
</blockquote>
<p>reset pointeur fifo spy Fepga 5</p>
<blockquote class="doxtable">
<p>fe.writeFifoInjectFE(5) </p>
</blockquote>
<p>écrit la fifo d'injection du fepga 5</p>
<blockquote class="doxtable">
<p>fe.writeFifoSpyFE(5) </p>
</blockquote>
<p>écrit la fifo de spy du fepga 5</p>
<blockquote class="doxtable">
<p>fe.writeFifoLLT() </p>
</blockquote>
<p>écrit la fifo de spy du trig pga</p>
<blockquote class="doxtable">
<p>fe.readFifoInjectFE(5, 1) </p>
</blockquote>
<p>lit la fifo d'injection du fepga 5 avec affichage (1)</p>
<blockquote class="doxtable">
<p>fe.readFifoSpyFE(5, 1) </p>
</blockquote>
<p>lit la fifo de spy du fepga 5 avec affichage (1)</p>
<blockquote class="doxtable">
<p>fe.readFifoLLTFE(5, 1) </p>
</blockquote>
<p>lit la fifo de LLT du fepga 5 avec affichage (1)</p>
<blockquote class="doxtable">
<p>fe.readFifoLLT(1) </p>
</blockquote>
<p>lit la fifo de spy du trig pga avec affichage (1)</p>
<h2>Configuration: </h2>
<blockquote class="doxtable">
<p>ConfBlock(1) </p>
</blockquote>
<p>configutation du block completed</p>
<blockquote class="doxtable">
<p>Configuration.confICECAL(4,0) </p>
</blockquote>
<p>configuration globale du ICECAL 4 avec un reard de clk de 0 setip</p>
<blockquote class="doxtable">
<p>fe.setProbeEnable(4,1) </p>
</blockquote>
<p>Positionne les probes en sorties</p>
<blockquote class="doxtable">
<p>fe.setTestDuration(value) </p>
</blockquote>
<p>charge value dans les registres de test duration de TOUS les FPGA (FE+Trig)</p>
<blockquote class="doxtable">
<p>fe.testDuration(fpga) </p>
</blockquote>
<p>lit la tes duration value du fpga FE (fpga 0 à 7) ou trig (fpga = -1)set</p>
<blockquote class="doxtable">
<p>fe.setStopInjLoop(value) </p>
</blockquote>
<p>charge value dans les registres de disable loop de TOUS les FPGA (FE+Trig)</p>
<blockquote class="doxtable">
<p>fe.stopInjLoop(fpga) </p>
</blockquote>
<p>lit la valeur du disale loop du fpga FE (fpga 0 à 7) ou trig (fpga = -1)</p>
<blockquote class="doxtable">
<p>fe.setClockFallingEdge(fe, ch, value) </p>
</blockquote>
<p>set clock edge to value to sample input data from fpga fe, channel ch</p>
<blockquote class="doxtable">
<p>fe.clockFallingEdge(fe, ch) </p>
</blockquote>
<p>clock edge to sample input data from fpga fe, channel ch</p>
<blockquote class="doxtable">
<p>fe.setClock80MHzFallingEdge(value) </p>
</blockquote>
<p>set clock 80MJHZ edge to value to sample input data SEQ FPGA</p>
<blockquote class="doxtable">
<p>fe.clock80MHzFallingEdge() </p>
</blockquote>
<p>clock edge to sample input data SEQ FPGA</p>
<blockquote class="doxtable">
<p>Configuration.setGBTClockPhase(gbt, ch, delay) </p>
</blockquote>
<p>set the clock phase for the channel ch of the GBTx gbt</p>
<h2>Test Programs: </h2>
<blockquote class="doxtable">
<p>testI2C() </p>
</blockquote>
<p>lance une écriture/lecture i2c sur l'adresse 0 du GBT de 0xAA = d170</p>
<blockquote class="doxtable">
<p>testSPI(value) </p>
</blockquote>
<p>ecrit value sur le registre de 3 du FE PGA 2 puis relit et affiche la valeur relue.</p>
<blockquote class="doxtable">
<p>InjProc(x) </p>
</blockquote>
<p>lance acquisition à partir de la fifo d'injection du Fpga x</p>
<blockquote class="doxtable">
<p>ADCProc(x) </p>
</blockquote>
<p>lance acquisition et lecture des fifo spy pour les donnees ADC, concerne le Fpga x</p>
<h2>LLT: </h2>
<blockquote class="doxtable">
<p>fe.latencyLLT() </p>
</blockquote>
<p>donne le status des latencies des voies dans le LLT</p>
<blockquote class="doxtable">
<p>fe.setLatencyLLT(latency) </p>
</blockquote>
<p>applique la latency pour les voies de la carte</p>
<blockquote class="doxtable">
<p>fe.setLatencyLLTSideNb(latency) </p>
</blockquote>
<p>applique la latency pour le Side neighbour</p>
<blockquote class="doxtable">
<p>fe.setLatencyLLTUpNb(latency) </p>
</blockquote>
<p>applique la latency pour le Up neighbour</p>
<blockquote class="doxtable">
<p>fe.setLatencyLLTCorner(latency) </p>
</blockquote>
<p>applique la latency pour la voie corner</p>
<blockquote class="doxtable">
<p>fe.maskLLT() </p>
</blockquote>
<p>donne le status des masques des voies dans le LLT</p>
<blockquote class="doxtable">
<p>fe.setMaskLLT(channel, status) </p>
</blockquote>
<p>applique le masque status pour la voie channel</p>
<blockquote class="doxtable">
<p>fe.setMaskLLTSideNb(channel, status) </p>
</blockquote>
<p>applique le masque status pour la voie channel arrivant de Side</p>
<blockquote class="doxtable">
<p>fe.setMaskLLTUpNb(channel, status) </p>
</blockquote>
<p>applique le masque status pour la voie channel venant de Up</p>
<blockquote class="doxtable">
<p>fe.setMaskLLTCorner(status) </p>
</blockquote>
<p>applique le masque status pour la voie corner</p>
<h2>GBT: </h2>
<blockquote class="doxtable">
<p>fe.setGbtMode(gbt,mode) </p>
</blockquote>
<p>Met le gbt 'gbt' dans mode 'mode'. 0 est mode normal, 1 est fixed pattern modeœ</p>
<blockquote class="doxtable">
<p>fe.gbtStatus(gbt) </p>
</blockquote>
<p>relie le status du gbt 'gbt'</p>
<blockquote class="doxtable">
<p>fe.setGbtDataPath(gbt, switch0, switch1, switch2) </p>
</blockquote>
<p>definie la position des 3 switchs du data path du gbt gbt</p>
<blockquote class="doxtable">
<p>Configuration.gbtDataPath(gbt) </p>
</blockquote>
<p>relit la configuration des 3 switchs du data path </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
